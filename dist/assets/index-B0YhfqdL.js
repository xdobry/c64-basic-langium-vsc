import{D as be,E as rt,S as st,b as Oe,T as it,k as Be,n as ot,e as at,f as ct,g as $e,h as We,i as ut,j as lt,C as Ge,L as ht,l as dt,R as pt,o as Ue,m as ve,p as qe,F as ke,q as gt,U as ft,t as mt,I as Ve,s as _t,u as kt,v as He,w as Ke,x as yt,y as Qe,z as Je,A as Ae,B as De,G as bt,H as St,J as X,K as Tt,N as Re,O as Xe,P as vt,Q as wt,V as Ct,W as Rt,X as Lt,Y as Fe,Z as At,_ as It,$ as xt,a0 as Pt,a1 as Mt,a2 as Et,a3 as Ye,a4 as Nt,a5 as Ot,a6 as Gt,a7 as Ze,a8 as Dt,a9 as Ft,aa as jt,ab as zt,ac as Bt}from"./wrapper-r2E7CgoD.js";function et(O,p){for(var T=0;T<p.length;T++){const R=p[T];if(typeof R!="string"&&!Array.isArray(R)){for(const x in R)if(x!=="default"&&!(x in O)){const C=Object.getOwnPropertyDescriptor(R,x);C&&Object.defineProperty(O,x,C.get?C:{enumerable:!0,get:()=>R[x]})}}}return Object.freeze(Object.defineProperty(O,Symbol.toStringTag,{value:"Module"}))}function Pe(O,p,T,R){var x=arguments.length,C=x<3?p:R===null?R=Object.getOwnPropertyDescriptor(p,T):R,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(O,p,T,R);else for(var d=O.length-1;d>=0;d--)(r=O[d])&&(C=(x<3?r(C):x>3?r(p,T,C):r(p,T))||C);return x>3&&C&&Object.defineProperty(p,T,C),C}function Z(O,p){return function(T,R){p(T,R,O)}}class $t extends be{constructor(p,T,R,x,C,r,d){super(),this._grammar=p,this._initialState=T,this._containsEmbeddedLanguages=R,this._createBackgroundTokenizer=x,this._backgroundTokenizerShouldOnlyVerifyTokens=C,this._reportTokenizationTime=r,this._reportSlowTokenization=d,this._seenLanguages=[],this._onDidEncounterLanguage=this._register(new rt),this.onDidEncounterLanguage=this._onDidEncounterLanguage.event}get backgroundTokenizerShouldOnlyVerifyTokens(){return this._backgroundTokenizerShouldOnlyVerifyTokens()}getInitialState(){return this._initialState}tokenize(p,T,R){throw new Error("Not supported!")}createBackgroundTokenizer(p,T){if(this._createBackgroundTokenizer)return this._createBackgroundTokenizer(p,T)}tokenizeEncoded(p,T,R){const x=Math.random()*1e4<1,C=this._reportSlowTokenization||x,r=C?new st(!0):void 0,d=this._grammar.tokenizeLine2(p,R,500);if(C){const n=r.elapsed();(x||n>32)&&this._reportTokenizationTime(n,p.length,x)}if(d.stoppedEarly)return console.warn(`Time limit reached when tokenizing line: ${p.substring(0,100)}`),new Oe(d.tokens,R);if(this._containsEmbeddedLanguages){const n=this._seenLanguages,_=d.tokens;for(let v=0,u=_.length>>>1;v<u;v++){const S=_[(v<<1)+1],L=it.getLanguageId(S);n[L]||(n[L]=!0,this._onDidEncounterLanguage.fire(L))}}let h;return R.equals(d.ruleStack)?h=R:h=d.ruleStack,new Oe(d.tokens,h)}}class Wt extends be{get backgroundTokenizerShouldOnlyVerifyTokens(){return this._actual.backgroundTokenizerShouldOnlyVerifyTokens}constructor(p,T,R){super(),this._encodedLanguageId=p,this._actual=T,this._maxTokenizationLineLength=R,this._register(Be(this._maxTokenizationLineLength))}getInitialState(){return this._actual.getInitialState()}tokenize(p,T,R){throw new Error("Not supported!")}tokenizeEncoded(p,T,R){return p.length>=this._maxTokenizationLineLength.get()?ot(this._encodedLanguageId,R):this._actual.tokenizeEncoded(p,T,R)}createBackgroundTokenizer(p,T){if(this._actual.createBackgroundTokenizer)return this._actual.createBackgroundTokenizer(p,T)}}class Ut{constructor(p){this.edits=p.slice().sort(at(T=>T.offset,ct))}applyToArray(p){for(let T=this.edits.length-1;T>=0;T--){const R=this.edits[T];p.splice(R.offset,R.length,...new Array(R.newLength))}}}class qt{constructor(p,T,R){this.offset=p,this.length=T,this.newLength=R}toString(){return`[${this.offset}, +${this.length}) -> +${this.newLength}}`}}class we{static fromMany(p){const T=p.map(R=>new we(R));return new Vt(T)}constructor(p){this.transformation=p,this.idx=0,this.offset=0}transform(p){let T=this.transformation.edits[this.idx];for(;T&&T.offset+T.length<=p;)this.offset+=T.newLength-T.length,this.idx++,T=this.transformation.edits[this.idx];if(!(T&&T.offset<=p))return p+this.offset}}class Vt{constructor(p){this.transformers=p}transform(p){for(const T of this.transformers){const R=T.transform(p);if(R===void 0)return;p=R}return p}}var tt={exports:{}};(function(O,p){var T={};(function(R,x){O.exports=x()})($e,function(){return(()=>{var R={350:(C,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.UseOnigurumaFindOptions=r.DebugFlags=void 0,r.DebugFlags={InDebugMode:typeof process<"u"&&!!T.VSCODE_TEXTMATE_DEBUG},r.UseOnigurumaFindOptions=!1},442:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.applyStateStackDiff=r.diffStateStacksRefEq=void 0;const h=d(391);r.diffStateStacksRefEq=function(n,_){let v=0;const u=[];let S=n,L=_;for(;S!==L;)S&&(!L||S.depth>=L.depth)?(v++,S=S.parent):(u.push(L.toStateStackFrame()),L=L.parent);return{pops:v,newFrames:u.reverse()}},r.applyStateStackDiff=function(n,_){let v=n;for(let u=0;u<_.pops;u++)v=v.parent;for(const u of _.newFrames)v=h.StateStackImpl.pushFrame(v,u);return v}},36:(C,r)=>{var d;Object.defineProperty(r,"__esModule",{value:!0}),r.toOptionalTokenType=r.EncodedTokenAttributes=void 0,(d=r.EncodedTokenAttributes||(r.EncodedTokenAttributes={})).toBinaryStr=function(h){let n=h.toString(2);for(;n.length<32;)n="0"+n;return n},d.print=function(h){const n=d.getLanguageId(h),_=d.getTokenType(h),v=d.getFontStyle(h),u=d.getForeground(h),S=d.getBackground(h);console.log({languageId:n,tokenType:_,fontStyle:v,foreground:u,background:S})},d.getLanguageId=function(h){return(255&h)>>>0},d.getTokenType=function(h){return(768&h)>>>8},d.containsBalancedBrackets=function(h){return(1024&h)!=0},d.getFontStyle=function(h){return(30720&h)>>>11},d.getForeground=function(h){return(16744448&h)>>>15},d.getBackground=function(h){return(4278190080&h)>>>24},d.set=function(h,n,_,v,u,S,L){let y=d.getLanguageId(h),w=d.getTokenType(h),k=d.containsBalancedBrackets(h)?1:0,g=d.getFontStyle(h),c=d.getForeground(h),m=d.getBackground(h);return n!==0&&(y=n),_!==8&&(w=_),v!==null&&(k=v?1:0),u!==-1&&(g=u),S!==0&&(c=S),L!==0&&(m=L),(y<<0|w<<8|k<<10|g<<11|c<<15|m<<24)>>>0},r.toOptionalTokenType=function(h){return h}},996:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.BasicScopeAttributesProvider=r.BasicScopeAttributes=void 0;const h=d(878);class n{constructor(S,L){this.languageId=S,this.tokenType=L}}r.BasicScopeAttributes=n;class _{constructor(S,L){this._getBasicScopeAttributes=new h.CachedFn(y=>{const w=this._scopeToLanguage(y),k=this._toStandardTokenType(y);return new n(w,k)}),this._defaultAttributes=new n(S,8),this._embeddedLanguagesMatcher=new v(Object.entries(L||{}))}getDefaultAttributes(){return this._defaultAttributes}getBasicScopeAttributes(S){return S===null?_._NULL_SCOPE_METADATA:this._getBasicScopeAttributes.get(S)}_scopeToLanguage(S){return this._embeddedLanguagesMatcher.match(S)||0}_toStandardTokenType(S){const L=S.match(_.STANDARD_TOKEN_TYPE_REGEXP);if(!L)return 8;switch(L[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"meta.embedded":return 0}throw new Error("Unexpected match for standard token type!")}}r.BasicScopeAttributesProvider=_,_._NULL_SCOPE_METADATA=new n(0,0),_.STANDARD_TOKEN_TYPE_REGEXP=/\b(comment|string|regex|meta\.embedded)\b/;class v{constructor(S){if(S.length===0)this.values=null,this.scopesRegExp=null;else{this.values=new Map(S);const L=S.map(([y,w])=>h.escapeRegExpCharacters(y));L.sort(),L.reverse(),this.scopesRegExp=new RegExp(`^((${L.join(")|(")}))($|\\.)`,"")}}match(S){if(!this.scopesRegExp)return;const L=S.match(this.scopesRegExp);return L?this.values.get(L[1]):void 0}}},947:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.LineTokens=r.BalancedBracketSelectors=r.StateStackImpl=r.AttributedScopeStack=r.Grammar=r.createGrammar=void 0;const h=d(350),n=d(36),_=d(736),v=d(44),u=d(792),S=d(583),L=d(878),y=d(996),w=d(47);function k(i,t,a,l,b){const A=_.createMatchers(t,g),P=u.RuleFactory.getCompiledRuleId(a,l,b.repository);for(const E of A)i.push({debugSelector:t,matcher:E.matcher,ruleId:P,grammar:b,priority:E.priority})}function g(i,t){if(t.length<i.length)return!1;let a=0;return i.every(l=>{for(let b=a;b<t.length;b++)if(c(t[b],l))return a=b+1,!0;return!1})}function c(i,t){if(!i)return!1;if(i===t)return!0;const a=t.length;return i.length>a&&i.substr(0,a)===t&&i[a]==="."}r.createGrammar=function(i,t,a,l,b,A,P,E){return new m(i,t,a,l,b,A,P,E)};class m{constructor(t,a,l,b,A,P,E,N){if(this._rootScopeName=t,this.balancedBracketSelectors=P,this._onigLib=N,this._basicScopeAttributesProvider=new y.BasicScopeAttributesProvider(l,b),this._rootId=-1,this._lastRuleId=0,this._ruleId2desc=[null],this._includedGrammars={},this._grammarRepository=E,this._grammar=f(a,null),this._injections=null,this._tokenTypeMatchers=[],A)for(const q of Object.keys(A)){const W=_.createMatchers(q,g);for(const D of W)this._tokenTypeMatchers.push({matcher:D.matcher,type:A[q]})}}get themeProvider(){return this._grammarRepository}dispose(){for(const t of this._ruleId2desc)t&&t.dispose()}createOnigScanner(t){return this._onigLib.createOnigScanner(t)}createOnigString(t){return this._onigLib.createOnigString(t)}getMetadataForScope(t){return this._basicScopeAttributesProvider.getBasicScopeAttributes(t)}_collectInjections(){const t=[],a=this._rootScopeName,l=(b=>b===this._rootScopeName?this._grammar:this.getExternalGrammar(b))(a);if(l){const b=l.injections;if(b)for(let P in b)k(t,P,b[P],this,l);const A=this._grammarRepository.injections(a);A&&A.forEach(P=>{const E=this.getExternalGrammar(P);if(E){const N=E.injectionSelector;N&&k(t,N,E,this,E)}})}return t.sort((b,A)=>b.priority-A.priority),t}getInjections(){if(this._injections===null&&(this._injections=this._collectInjections(),h.DebugFlags.InDebugMode&&this._injections.length>0)){console.log(`Grammar ${this._rootScopeName} contains the following injections:`);for(const t of this._injections)console.log(`  - ${t.debugSelector}`)}return this._injections}registerRule(t){const a=++this._lastRuleId,l=t(u.ruleIdFromNumber(a));return this._ruleId2desc[a]=l,l}getRule(t){return this._ruleId2desc[u.ruleIdToNumber(t)]}getExternalGrammar(t,a){if(this._includedGrammars[t])return this._includedGrammars[t];if(this._grammarRepository){const l=this._grammarRepository.lookup(t);if(l)return this._includedGrammars[t]=f(l,a&&a.$base),this._includedGrammars[t]}}tokenizeLine(t,a,l=0){const b=this._tokenize(t,a,!1,l);return{tokens:b.lineTokens.getResult(b.ruleStack,b.lineLength),ruleStack:b.ruleStack,stoppedEarly:b.stoppedEarly}}tokenizeLine2(t,a,l=0){const b=this._tokenize(t,a,!0,l);return{tokens:b.lineTokens.getBinaryResult(b.ruleStack,b.lineLength),ruleStack:b.ruleStack,stoppedEarly:b.stoppedEarly}}_tokenize(t,a,l,b){let A;if(this._rootId===-1&&(this._rootId=u.RuleFactory.getCompiledRuleId(this._grammar.repository.$self,this,this._grammar.repository),this.getInjections()),a&&a!==e.NULL)A=!1,a.reset();else{A=!0;const W=this._basicScopeAttributesProvider.getDefaultAttributes(),D=this.themeProvider.getDefaults(),z=n.EncodedTokenAttributes.set(0,W.languageId,W.tokenType,null,D.fontStyle,D.foregroundId,D.backgroundId),Q=this.getRule(this._rootId).getName(null,null);let K;K=Q?o.createRootAndLookUpScopeName(Q,z,this):o.createRoot("unknown",z),a=new e(null,this._rootId,-1,-1,!1,null,K,K)}t+=`
`;const P=this.createOnigString(t),E=P.content.length,N=new s(l,t,this._tokenTypeMatchers,this.balancedBracketSelectors),q=w._tokenizeString(this,P,A,0,a,N,!0,b);return v.disposeOnigString(P),{lineLength:E,lineTokens:N,ruleStack:q.stack,stoppedEarly:q.stoppedEarly}}}function f(i,t){return(i=L.clone(i)).repository=i.repository||{},i.repository.$self={$vscodeTextmateLocation:i.$vscodeTextmateLocation,patterns:i.patterns,name:i.scopeName},i.repository.$base=t||i.repository.$self,i}r.Grammar=m;class o{constructor(t,a,l){this.parent=t,this.scopePath=a,this.tokenAttributes=l}static fromExtension(t,a){let l=t,b=t?.scopePath??null;for(const A of a)b=S.ScopeStack.push(b,A.scopeNames),l=new o(l,b,A.encodedTokenAttributes);return l}static createRoot(t,a){return new o(null,new S.ScopeStack(null,t),a)}static createRootAndLookUpScopeName(t,a,l){const b=l.getMetadataForScope(t),A=new S.ScopeStack(null,t),P=l.themeProvider.themeMatch(A),E=o.mergeAttributes(a,b,P);return new o(null,A,E)}get scopeName(){return this.scopePath.scopeName}toString(){return this.getScopeNames().join(" ")}equals(t){return o.equals(this,t)}static equals(t,a){for(;;){if(t===a||!t&&!a)return!0;if(!t||!a||t.scopeName!==a.scopeName||t.tokenAttributes!==a.tokenAttributes)return!1;t=t.parent,a=a.parent}}static mergeAttributes(t,a,l){let b=-1,A=0,P=0;return l!==null&&(b=l.fontStyle,A=l.foregroundId,P=l.backgroundId),n.EncodedTokenAttributes.set(t,a.languageId,a.tokenType,null,b,A,P)}pushAttributed(t,a){if(t===null)return this;if(t.indexOf(" ")===-1)return o._pushAttributed(this,t,a);const l=t.split(/ /g);let b=this;for(const A of l)b=o._pushAttributed(b,A,a);return b}static _pushAttributed(t,a,l){const b=l.getMetadataForScope(a),A=t.scopePath.push(a),P=l.themeProvider.themeMatch(A),E=o.mergeAttributes(t.tokenAttributes,b,P);return new o(t,A,E)}getScopeNames(){return this.scopePath.getSegments()}getExtensionIfDefined(t){const a=[];let l=this;for(;l&&l!==t;)a.push({encodedTokenAttributes:l.tokenAttributes,scopeNames:l.scopePath.getExtensionIfDefined(l.parent?.scopePath??null)}),l=l.parent;return l===t?a.reverse():void 0}}r.AttributedScopeStack=o;class e{constructor(t,a,l,b,A,P,E,N){this.parent=t,this.ruleId=a,this.beginRuleCapturedEOL=A,this.endRule=P,this.nameScopesList=E,this.contentNameScopesList=N,this._stackElementBrand=void 0,this.depth=this.parent?this.parent.depth+1:1,this._enterPos=l,this._anchorPos=b}equals(t){return t!==null&&e._equals(this,t)}static _equals(t,a){return t===a||!!this._structuralEquals(t,a)&&o.equals(t.contentNameScopesList,a.contentNameScopesList)}static _structuralEquals(t,a){for(;;){if(t===a||!t&&!a)return!0;if(!t||!a||t.depth!==a.depth||t.ruleId!==a.ruleId||t.endRule!==a.endRule)return!1;t=t.parent,a=a.parent}}clone(){return this}static _reset(t){for(;t;)t._enterPos=-1,t._anchorPos=-1,t=t.parent}reset(){e._reset(this)}pop(){return this.parent}safePop(){return this.parent?this.parent:this}push(t,a,l,b,A,P,E){return new e(this,t,a,l,b,A,P,E)}getEnterPos(){return this._enterPos}getAnchorPos(){return this._anchorPos}getRule(t){return t.getRule(this.ruleId)}toString(){const t=[];return this._writeString(t,0),"["+t.join(",")+"]"}_writeString(t,a){return this.parent&&(a=this.parent._writeString(t,a)),t[a++]=`(${this.ruleId}, ${this.nameScopesList?.toString()}, ${this.contentNameScopesList?.toString()})`,a}withContentNameScopesList(t){return this.contentNameScopesList===t?this:this.parent.push(this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,this.endRule,this.nameScopesList,t)}withEndRule(t){return this.endRule===t?this:new e(this.parent,this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,t,this.nameScopesList,this.contentNameScopesList)}hasSameRuleAs(t){let a=this;for(;a&&a._enterPos===t._enterPos;){if(a.ruleId===t.ruleId)return!0;a=a.parent}return!1}toStateStackFrame(){return{ruleId:u.ruleIdToNumber(this.ruleId),beginRuleCapturedEOL:this.beginRuleCapturedEOL,endRule:this.endRule,nameScopesList:this.nameScopesList?.getExtensionIfDefined(this.parent?.nameScopesList??null)??[],contentNameScopesList:this.contentNameScopesList?.getExtensionIfDefined(this.nameScopesList)??[]}}static pushFrame(t,a){const l=o.fromExtension(t?.nameScopesList??null,a.nameScopesList);return new e(t,u.ruleIdFromNumber(a.ruleId),a.enterPos??-1,a.anchorPos??-1,a.beginRuleCapturedEOL,a.endRule,l,o.fromExtension(l,a.contentNameScopesList))}}r.StateStackImpl=e,e.NULL=new e(null,0,0,0,!1,null,null,null),r.BalancedBracketSelectors=class{constructor(i,t){this.allowAny=!1,this.balancedBracketScopes=i.flatMap(a=>a==="*"?(this.allowAny=!0,[]):_.createMatchers(a,g).map(l=>l.matcher)),this.unbalancedBracketScopes=t.flatMap(a=>_.createMatchers(a,g).map(l=>l.matcher))}get matchesAlways(){return this.allowAny&&this.unbalancedBracketScopes.length===0}get matchesNever(){return this.balancedBracketScopes.length===0&&!this.allowAny}match(i){for(const t of this.unbalancedBracketScopes)if(t(i))return!1;for(const t of this.balancedBracketScopes)if(t(i))return!0;return this.allowAny}};class s{constructor(t,a,l,b){this.balancedBracketSelectors=b,this._emitBinaryTokens=t,this._tokenTypeOverrides=l,h.DebugFlags.InDebugMode?this._lineText=a:this._lineText=null,this._tokens=[],this._binaryTokens=[],this._lastTokenEndIndex=0}produce(t,a){this.produceFromScopes(t.contentNameScopesList,a)}produceFromScopes(t,a){if(this._lastTokenEndIndex>=a)return;if(this._emitBinaryTokens){let b=t?.tokenAttributes??0,A=!1;if(this.balancedBracketSelectors?.matchesAlways&&(A=!0),this._tokenTypeOverrides.length>0||this.balancedBracketSelectors&&!this.balancedBracketSelectors.matchesAlways&&!this.balancedBracketSelectors.matchesNever){const P=t?.getScopeNames()??[];for(const E of this._tokenTypeOverrides)E.matcher(P)&&(b=n.EncodedTokenAttributes.set(b,0,n.toOptionalTokenType(E.type),null,-1,0,0));this.balancedBracketSelectors&&(A=this.balancedBracketSelectors.match(P))}if(A&&(b=n.EncodedTokenAttributes.set(b,0,8,A,-1,0,0)),this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-1]===b)return void(this._lastTokenEndIndex=a);if(h.DebugFlags.InDebugMode){const P=t?.getScopeNames()??[];console.log("  token: |"+this._lineText.substring(this._lastTokenEndIndex,a).replace(/\n$/,"\\n")+"|");for(let E=0;E<P.length;E++)console.log("      * "+P[E])}return this._binaryTokens.push(this._lastTokenEndIndex),this._binaryTokens.push(b),void(this._lastTokenEndIndex=a)}const l=t?.getScopeNames()??[];if(h.DebugFlags.InDebugMode){console.log("  token: |"+this._lineText.substring(this._lastTokenEndIndex,a).replace(/\n$/,"\\n")+"|");for(let b=0;b<l.length;b++)console.log("      * "+l[b])}this._tokens.push({startIndex:this._lastTokenEndIndex,endIndex:a,scopes:l}),this._lastTokenEndIndex=a}getResult(t,a){return this._tokens.length>0&&this._tokens[this._tokens.length-1].startIndex===a-1&&this._tokens.pop(),this._tokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(t,a),this._tokens[this._tokens.length-1].startIndex=0),this._tokens}getBinaryResult(t,a){this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-2]===a-1&&(this._binaryTokens.pop(),this._binaryTokens.pop()),this._binaryTokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(t,a),this._binaryTokens[this._binaryTokens.length-2]=0);const l=new Uint32Array(this._binaryTokens.length);for(let b=0,A=this._binaryTokens.length;b<A;b++)l[b]=this._binaryTokens[b];return l}}r.LineTokens=s},965:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.parseInclude=r.TopLevelRepositoryReference=r.TopLevelReference=r.RelativeReference=r.SelfReference=r.BaseReference=r.ScopeDependencyProcessor=r.ExternalReferenceCollector=r.TopLevelRepositoryRuleReference=r.TopLevelRuleReference=void 0;const h=d(878);class n{constructor(e){this.scopeName=e}toKey(){return this.scopeName}}r.TopLevelRuleReference=n;class _{constructor(e,s){this.scopeName=e,this.ruleName=s}toKey(){return`${this.scopeName}#${this.ruleName}`}}r.TopLevelRepositoryRuleReference=_;class v{constructor(){this._references=[],this._seenReferenceKeys=new Set,this.visitedRule=new Set}get references(){return this._references}add(e){const s=e.toKey();this._seenReferenceKeys.has(s)||(this._seenReferenceKeys.add(s),this._references.push(e))}}function u(o,e,s,i){const t=s.lookup(o.scopeName);if(!t){if(o.scopeName===e)throw new Error(`No grammar provided for <${e}>`);return}const a=s.lookup(e);o instanceof n?L({baseGrammar:a,selfGrammar:t},i):S(o.ruleName,{baseGrammar:a,selfGrammar:t,repository:t.repository},i);const l=s.injections(o.scopeName);if(l)for(const b of l)i.add(new n(b))}function S(o,e,s){e.repository&&e.repository[o]&&y([e.repository[o]],e,s)}function L(o,e){o.selfGrammar.patterns&&Array.isArray(o.selfGrammar.patterns)&&y(o.selfGrammar.patterns,{...o,repository:o.selfGrammar.repository},e),o.selfGrammar.injections&&y(Object.values(o.selfGrammar.injections),{...o,repository:o.selfGrammar.repository},e)}function y(o,e,s){for(const i of o){if(s.visitedRule.has(i))continue;s.visitedRule.add(i);const t=i.repository?h.mergeObjects({},e.repository,i.repository):e.repository;Array.isArray(i.patterns)&&y(i.patterns,{...e,repository:t},s);const a=i.include;if(!a)continue;const l=f(a);switch(l.kind){case 0:L({...e,selfGrammar:e.baseGrammar},s);break;case 1:L(e,s);break;case 2:S(l.ruleName,{...e,repository:t},s);break;case 3:case 4:const b=l.scopeName===e.selfGrammar.scopeName?e.selfGrammar:l.scopeName===e.baseGrammar.scopeName?e.baseGrammar:void 0;if(b){const A={baseGrammar:e.baseGrammar,selfGrammar:b,repository:t};l.kind===4?S(l.ruleName,A,s):L(A,s)}else l.kind===4?s.add(new _(l.scopeName,l.ruleName)):s.add(new n(l.scopeName))}}}r.ExternalReferenceCollector=v,r.ScopeDependencyProcessor=class{constructor(o,e){this.repo=o,this.initialScopeName=e,this.seenFullScopeRequests=new Set,this.seenPartialScopeRequests=new Set,this.seenFullScopeRequests.add(this.initialScopeName),this.Q=[new n(this.initialScopeName)]}processQueue(){const o=this.Q;this.Q=[];const e=new v;for(const s of o)u(s,this.initialScopeName,this.repo,e);for(const s of e.references)if(s instanceof n){if(this.seenFullScopeRequests.has(s.scopeName))continue;this.seenFullScopeRequests.add(s.scopeName),this.Q.push(s)}else{if(this.seenFullScopeRequests.has(s.scopeName)||this.seenPartialScopeRequests.has(s.toKey()))continue;this.seenPartialScopeRequests.add(s.toKey()),this.Q.push(s)}}};class w{constructor(){this.kind=0}}r.BaseReference=w;class k{constructor(){this.kind=1}}r.SelfReference=k;class g{constructor(e){this.ruleName=e,this.kind=2}}r.RelativeReference=g;class c{constructor(e){this.scopeName=e,this.kind=3}}r.TopLevelReference=c;class m{constructor(e,s){this.scopeName=e,this.ruleName=s,this.kind=4}}function f(o){if(o==="$base")return new w;if(o==="$self")return new k;const e=o.indexOf("#");if(e===-1)return new c(o);if(e===0)return new g(o.substring(1));{const s=o.substring(0,e),i=o.substring(e+1);return new m(s,i)}}r.TopLevelRepositoryReference=m,r.parseInclude=f},391:function(C,r,d){var h=this&&this.__createBinding||(Object.create?function(_,v,u,S){S===void 0&&(S=u),Object.defineProperty(_,S,{enumerable:!0,get:function(){return v[u]}})}:function(_,v,u,S){S===void 0&&(S=u),_[S]=v[u]}),n=this&&this.__exportStar||function(_,v){for(var u in _)u==="default"||Object.prototype.hasOwnProperty.call(v,u)||h(v,_,u)};Object.defineProperty(r,"__esModule",{value:!0}),n(d(947),r)},47:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.LocalStackElement=r._tokenizeString=void 0;const h=d(350),n=d(44),_=d(792),v=d(878);class u{constructor(m,f){this.stack=m,this.stoppedEarly=f}}function S(c,m,f,o,e,s,i,t){const a=m.content.length;let l=!1,b=-1;if(i){const E=function(N,q,W,D,z,Q){let K=z.beginRuleCapturedEOL?0:-1;const B=[];for(let j=z;j;j=j.pop()){const F=j.getRule(N);F instanceof _.BeginWhileRule&&B.push({rule:F,stack:j})}for(let j=B.pop();j;j=B.pop()){const{ruleScanner:F,findOptions:se}=y(j.rule,N,j.stack.endRule,W,D===K),I=F.findNextMatchSync(q,D,se);if(h.DebugFlags.InDebugMode&&(console.log("  scanning for while rule"),console.log(F.toString())),!I){h.DebugFlags.InDebugMode&&console.log("  popping "+j.rule.debugName+" - "+j.rule.debugWhileRegExp),z=j.stack.pop();break}if(I.ruleId!==_.whileRuleId){z=j.stack.pop();break}I.captureIndices&&I.captureIndices.length&&(Q.produce(j.stack,I.captureIndices[0].start),k(N,q,W,j.stack,Q,j.rule.whileCaptures,I.captureIndices),Q.produce(j.stack,I.captureIndices[0].end),K=I.captureIndices[0].end,I.captureIndices[0].end>D&&(D=I.captureIndices[0].end,W=!1))}return{stack:z,linePos:D,anchorPosition:K,isFirstLine:W}}(c,m,f,o,e,s);e=E.stack,o=E.linePos,f=E.isFirstLine,b=E.anchorPosition}const A=Date.now();for(;!l;){if(t!==0&&Date.now()-A>t)return new u(e,!0);P()}return new u(e,!1);function P(){h.DebugFlags.InDebugMode&&(console.log(""),console.log(`@@scanNext ${o}: |${m.content.substr(o).replace(/\n$/,"\\n")}|`));const E=function(D,z,Q,K,B,j){const F=function(te,ce,ue,le,oe,fe){const he=oe.getRule(te),{ruleScanner:de,findOptions:pe}=L(he,te,oe.endRule,ue,le===fe);let ne=0;h.DebugFlags.InDebugMode&&(ne=v.performanceNow());const ee=de.findNextMatchSync(ce,le,pe);if(h.DebugFlags.InDebugMode){const ge=v.performanceNow()-ne;ge>5&&console.warn(`Rule ${he.debugName} (${he.id}) matching took ${ge} against '${ce}'`),console.log(`  scanning for (linePos: ${le}, anchorPosition: ${fe})`),console.log(de.toString()),ee&&console.log(`matched rule id: ${ee.ruleId} from ${ee.captureIndices[0].start} to ${ee.captureIndices[0].end}`)}return ee?{captureIndices:ee.captureIndices,matchedRuleId:ee.ruleId}:null}(D,z,Q,K,B,j),se=D.getInjections();if(se.length===0)return F;const I=function(te,ce,ue,le,oe,fe,he){let de,pe=Number.MAX_VALUE,ne=null,ee=0;const ge=fe.contentNameScopesList.getScopeNames();for(let M=0,G=te.length;M<G;M++){const J=te[M];if(!J.matcher(ge))continue;const re=ce.getRule(J.ruleId),{ruleScanner:U,findOptions:V}=L(re,ce,null,le,oe===he),Y=U.findNextMatchSync(ue,oe,V);if(!Y)continue;h.DebugFlags.InDebugMode&&(console.log(`  matched injection: ${J.debugSelector}`),console.log(U.toString()));const ie=Y.captureIndices[0].start;if(!(ie>=pe)&&(pe=ie,ne=Y.captureIndices,de=Y.ruleId,ee=J.priority,pe===oe))break}return ne?{priorityMatch:ee===-1,captureIndices:ne,matchedRuleId:de}:null}(se,D,z,Q,K,B,j);if(!I)return F;if(!F)return I;const H=F.captureIndices[0].start,$=I.captureIndices[0].start;return $<H||I.priorityMatch&&$===H?I:F}(c,m,f,o,e,b);if(!E)return h.DebugFlags.InDebugMode&&console.log("  no more matches."),s.produce(e,a),void(l=!0);const N=E.captureIndices,q=E.matchedRuleId,W=!!(N&&N.length>0)&&N[0].end>o;if(q===_.endRuleId){const D=e.getRule(c);h.DebugFlags.InDebugMode&&console.log("  popping "+D.debugName+" - "+D.debugEndRegExp),s.produce(e,N[0].start),e=e.withContentNameScopesList(e.nameScopesList),k(c,m,f,e,s,D.endCaptures,N),s.produce(e,N[0].end);const z=e;if(e=e.parent,b=z.getAnchorPos(),!W&&z.getEnterPos()===o)return h.DebugFlags.InDebugMode&&console.error("[1] - Grammar is in an endless loop - Grammar pushed & popped a rule without advancing"),e=z,s.produce(e,a),void(l=!0)}else{const D=c.getRule(q);s.produce(e,N[0].start);const z=e,Q=D.getName(m.content,N),K=e.contentNameScopesList.pushAttributed(Q,c);if(e=e.push(q,o,b,N[0].end===a,null,K,K),D instanceof _.BeginEndRule){const B=D;h.DebugFlags.InDebugMode&&console.log("  pushing "+B.debugName+" - "+B.debugBeginRegExp),k(c,m,f,e,s,B.beginCaptures,N),s.produce(e,N[0].end),b=N[0].end;const j=B.getContentName(m.content,N),F=K.pushAttributed(j,c);if(e=e.withContentNameScopesList(F),B.endHasBackReferences&&(e=e.withEndRule(B.getEndWithResolvedBackReferences(m.content,N))),!W&&z.hasSameRuleAs(e))return h.DebugFlags.InDebugMode&&console.error("[2] - Grammar is in an endless loop - Grammar pushed the same rule without advancing"),e=e.pop(),s.produce(e,a),void(l=!0)}else if(D instanceof _.BeginWhileRule){const B=D;h.DebugFlags.InDebugMode&&console.log("  pushing "+B.debugName),k(c,m,f,e,s,B.beginCaptures,N),s.produce(e,N[0].end),b=N[0].end;const j=B.getContentName(m.content,N),F=K.pushAttributed(j,c);if(e=e.withContentNameScopesList(F),B.whileHasBackReferences&&(e=e.withEndRule(B.getWhileWithResolvedBackReferences(m.content,N))),!W&&z.hasSameRuleAs(e))return h.DebugFlags.InDebugMode&&console.error("[3] - Grammar is in an endless loop - Grammar pushed the same rule without advancing"),e=e.pop(),s.produce(e,a),void(l=!0)}else{const B=D;if(h.DebugFlags.InDebugMode&&console.log("  matched "+B.debugName+" - "+B.debugMatchRegExp),k(c,m,f,e,s,B.captures,N),s.produce(e,N[0].end),e=e.pop(),!W)return h.DebugFlags.InDebugMode&&console.error("[4] - Grammar is in an endless loop - Grammar is not advancing, nor is it pushing/popping"),e=e.safePop(),s.produce(e,a),void(l=!0)}}N[0].end>o&&(o=N[0].end,f=!1)}}function L(c,m,f,o,e){return h.UseOnigurumaFindOptions?{ruleScanner:c.compile(m,f),findOptions:w(o,e)}:{ruleScanner:c.compileAG(m,f,o,e),findOptions:0}}function y(c,m,f,o,e){return h.UseOnigurumaFindOptions?{ruleScanner:c.compileWhile(m,f),findOptions:w(o,e)}:{ruleScanner:c.compileWhileAG(m,f,o,e),findOptions:0}}function w(c,m){let f=0;return c||(f|=1),m||(f|=4),f}function k(c,m,f,o,e,s,i){if(s.length===0)return;const t=m.content,a=Math.min(s.length,i.length),l=[],b=i[0].end;for(let A=0;A<a;A++){const P=s[A];if(P===null)continue;const E=i[A];if(E.length===0)continue;if(E.start>b)break;for(;l.length>0&&l[l.length-1].endPos<=E.start;)e.produceFromScopes(l[l.length-1].scopes,l[l.length-1].endPos),l.pop();if(l.length>0?e.produceFromScopes(l[l.length-1].scopes,E.start):e.produce(o,E.start),P.retokenizeCapturedWithRuleId){const q=P.getName(t,i),W=o.contentNameScopesList.pushAttributed(q,c),D=P.getContentName(t,i),z=W.pushAttributed(D,c),Q=o.push(P.retokenizeCapturedWithRuleId,E.start,-1,!1,null,W,z),K=c.createOnigString(t.substring(0,E.end));S(c,K,f&&E.start===0,E.start,Q,e,!1,0),n.disposeOnigString(K);continue}const N=P.getName(t,i);if(N!==null){const q=(l.length>0?l[l.length-1].scopes:o.contentNameScopesList).pushAttributed(N,c);l.push(new g(q,E.end))}}for(;l.length>0;)e.produceFromScopes(l[l.length-1].scopes,l[l.length-1].endPos),l.pop()}r._tokenizeString=S;class g{constructor(m,f){this.scopes=m,this.endPos=f}}r.LocalStackElement=g},974:(C,r)=>{function d(v,u){throw new Error("Near offset "+v.pos+": "+u+" ~~~"+v.source.substr(v.pos,50)+"~~~")}Object.defineProperty(r,"__esModule",{value:!0}),r.parseJSON=void 0,r.parseJSON=function(v,u,S){let L=new h(v),y=new n,w=0,k=null,g=[],c=[];function m(){g.push(w),c.push(k)}function f(){w=g.pop(),k=c.pop()}function o(e){d(L,e)}for(;_(L,y);){if(w===0){if(k!==null&&o("too many constructs in root"),y.type===3){k={},S&&(k.$vscodeTextmateLocation=y.toLocation(u)),m(),w=1;continue}if(y.type===2){k=[],m(),w=4;continue}o("unexpected token in root")}if(w===2){if(y.type===5){f();continue}if(y.type===7){w=3;continue}o("expected , or }")}if(w===1||w===3){if(w===1&&y.type===5){f();continue}if(y.type===1){let e=y.value;if(_(L,y)&&y.type===6||o("expected colon"),_(L,y)||o("expected value"),w=2,y.type===1){k[e]=y.value;continue}if(y.type===8){k[e]=null;continue}if(y.type===9){k[e]=!0;continue}if(y.type===10){k[e]=!1;continue}if(y.type===11){k[e]=parseFloat(y.value);continue}if(y.type===2){let s=[];k[e]=s,m(),w=4,k=s;continue}if(y.type===3){let s={};S&&(s.$vscodeTextmateLocation=y.toLocation(u)),k[e]=s,m(),w=1,k=s;continue}}o("unexpected token in dict")}if(w===5){if(y.type===4){f();continue}if(y.type===7){w=6;continue}o("expected , or ]")}if(w===4||w===6){if(w===4&&y.type===4){f();continue}if(w=5,y.type===1){k.push(y.value);continue}if(y.type===8){k.push(null);continue}if(y.type===9){k.push(!0);continue}if(y.type===10){k.push(!1);continue}if(y.type===11){k.push(parseFloat(y.value));continue}if(y.type===2){let e=[];k.push(e),m(),w=4,k=e;continue}if(y.type===3){let e={};S&&(e.$vscodeTextmateLocation=y.toLocation(u)),k.push(e),m(),w=1,k=e;continue}o("unexpected token in array")}o("unknown state")}return c.length!==0&&o("unclosed constructs"),k};class h{constructor(u){this.source=u,this.pos=0,this.len=u.length,this.line=1,this.char=0}}class n{constructor(){this.value=null,this.type=0,this.offset=-1,this.len=-1,this.line=-1,this.char=-1}toLocation(u){return{filename:u,line:this.line,char:this.char}}}function _(v,u){u.value=null,u.type=0,u.offset=-1,u.len=-1,u.line=-1,u.char=-1;let S,L=v.source,y=v.pos,w=v.len,k=v.line,g=v.char;for(;;){if(y>=w)return!1;if(S=L.charCodeAt(y),S!==32&&S!==9&&S!==13){if(S!==10)break;y++,k++,g=0}else y++,g++}if(u.offset=y,u.line=k,u.char=g,S===34){for(u.type=1,y++,g++;;){if(y>=w)return!1;if(S=L.charCodeAt(y),y++,g++,S!==92){if(S===34)break}else y++,g++}u.value=L.substring(u.offset+1,y-1).replace(/\\u([0-9A-Fa-f]{4})/g,(c,m)=>String.fromCodePoint(parseInt(m,16))).replace(/\\(.)/g,(c,m)=>{switch(m){case'"':return'"';case"\\":return"\\";case"/":return"/";case"b":return"\b";case"f":return"\f";case"n":return`
`;case"r":return"\r";case"t":return"	";default:d(v,"invalid escape sequence")}throw new Error("unreachable")})}else if(S===91)u.type=2,y++,g++;else if(S===123)u.type=3,y++,g++;else if(S===93)u.type=4,y++,g++;else if(S===125)u.type=5,y++,g++;else if(S===58)u.type=6,y++,g++;else if(S===44)u.type=7,y++,g++;else if(S===110){if(u.type=8,y++,g++,S=L.charCodeAt(y),S!==117||(y++,g++,S=L.charCodeAt(y),S!==108)||(y++,g++,S=L.charCodeAt(y),S!==108))return!1;y++,g++}else if(S===116){if(u.type=9,y++,g++,S=L.charCodeAt(y),S!==114||(y++,g++,S=L.charCodeAt(y),S!==117)||(y++,g++,S=L.charCodeAt(y),S!==101))return!1;y++,g++}else if(S===102){if(u.type=10,y++,g++,S=L.charCodeAt(y),S!==97||(y++,g++,S=L.charCodeAt(y),S!==108)||(y++,g++,S=L.charCodeAt(y),S!==115)||(y++,g++,S=L.charCodeAt(y),S!==101))return!1;y++,g++}else for(u.type=11;;){if(y>=w)return!1;if(S=L.charCodeAt(y),!(S===46||S>=48&&S<=57||S===101||S===69||S===45||S===43))break;y++,g++}return u.len=y-u.offset,u.value===null&&(u.value=L.substr(u.offset,u.len)),v.pos=y,v.line=k,v.char=g,!0}},787:function(C,r,d){var h=this&&this.__createBinding||(Object.create?function(w,k,g,c){c===void 0&&(c=g),Object.defineProperty(w,c,{enumerable:!0,get:function(){return k[g]}})}:function(w,k,g,c){c===void 0&&(c=g),w[c]=k[g]}),n=this&&this.__exportStar||function(w,k){for(var g in w)g==="default"||Object.prototype.hasOwnProperty.call(k,g)||h(k,w,g)};Object.defineProperty(r,"__esModule",{value:!0}),r.applyStateStackDiff=r.diffStateStacksRefEq=r.parseRawGrammar=r.INITIAL=r.Registry=void 0;const _=d(391),v=d(50),u=d(652),S=d(583),L=d(965),y=d(442);Object.defineProperty(r,"applyStateStackDiff",{enumerable:!0,get:function(){return y.applyStateStackDiff}}),Object.defineProperty(r,"diffStateStacksRefEq",{enumerable:!0,get:function(){return y.diffStateStacksRefEq}}),n(d(44),r),r.Registry=class{constructor(w){this._options=w,this._syncRegistry=new u.SyncRegistry(S.Theme.createFromRawTheme(w.theme,w.colorMap),w.onigLib),this._ensureGrammarCache=new Map}dispose(){this._syncRegistry.dispose()}setTheme(w,k){this._syncRegistry.setTheme(S.Theme.createFromRawTheme(w,k))}getColorMap(){return this._syncRegistry.getColorMap()}loadGrammarWithEmbeddedLanguages(w,k,g){return this.loadGrammarWithConfiguration(w,k,{embeddedLanguages:g})}loadGrammarWithConfiguration(w,k,g){return this._loadGrammar(w,k,g.embeddedLanguages,g.tokenTypes,new _.BalancedBracketSelectors(g.balancedBracketSelectors||[],g.unbalancedBracketSelectors||[]))}loadGrammar(w){return this._loadGrammar(w,0,null,null,null)}async _loadGrammar(w,k,g,c,m){const f=new L.ScopeDependencyProcessor(this._syncRegistry,w);for(;f.Q.length>0;)await Promise.all(f.Q.map(o=>this._loadSingleGrammar(o.scopeName))),f.processQueue();return this._grammarForScopeName(w,k,g,c,m)}async _loadSingleGrammar(w){return this._ensureGrammarCache.has(w)||this._ensureGrammarCache.set(w,this._doLoadSingleGrammar(w)),this._ensureGrammarCache.get(w)}async _doLoadSingleGrammar(w){const k=await this._options.loadGrammar(w);if(k){const g=typeof this._options.getInjections=="function"?this._options.getInjections(w):void 0;this._syncRegistry.addGrammar(k,g)}}async addGrammar(w,k=[],g=0,c=null){return this._syncRegistry.addGrammar(w,k),await this._grammarForScopeName(w.scopeName,g,c)}_grammarForScopeName(w,k=0,g=null,c=null,m=null){return this._syncRegistry.grammarForScopeName(w,k,g,c,m)}},r.INITIAL=_.StateStackImpl.NULL,r.parseRawGrammar=v.parseRawGrammar},736:(C,r)=>{function d(h){return!!h&&!!h.match(/[\w\.:]+/)}Object.defineProperty(r,"__esModule",{value:!0}),r.createMatchers=void 0,r.createMatchers=function(h,n){const _=[],v=function(y){let w=/([LR]:|[\w\.:][\w\.:\-]*|[\,\|\-\(\)])/g,k=w.exec(y);return{next:()=>{if(!k)return null;const g=k[0];return k=w.exec(y),g}}}(h);let u=v.next();for(;u!==null;){let y=0;if(u.length===2&&u.charAt(1)===":"){switch(u.charAt(0)){case"R":y=1;break;case"L":y=-1;break;default:console.log(`Unknown priority ${u} in scope selector`)}u=v.next()}let w=L();if(_.push({matcher:w,priority:y}),u!==",")break;u=v.next()}return _;function S(){if(u==="-"){u=v.next();const y=S();return w=>!!y&&!y(w)}if(u==="("){u=v.next();const y=function(){const w=[];let k=L();for(;k&&(w.push(k),u==="|"||u===",");){do u=v.next();while(u==="|"||u===",");k=L()}return g=>w.some(c=>c(g))}();return u===")"&&(u=v.next()),y}if(d(u)){const y=[];do y.push(u),u=v.next();while(d(u));return w=>n(y,w)}return null}function L(){const y=[];let w=S();for(;w;)y.push(w),w=S();return k=>y.every(g=>g(k))}}},44:(C,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.disposeOnigString=void 0,r.disposeOnigString=function(d){typeof d.dispose=="function"&&d.dispose()}},50:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.parseRawGrammar=void 0;const h=d(69),n=d(350),_=d(974);r.parseRawGrammar=function(v,u=null){return u!==null&&/\.json$/.test(u)?(S=v,L=u,n.DebugFlags.InDebugMode?_.parseJSON(S,L,!0):JSON.parse(S)):function(y,w){return n.DebugFlags.InDebugMode?h.parseWithLocation(y,w,"$vscodeTextmateLocation"):h.parsePLIST(y)}(v,u);var S,L}},69:(C,r)=>{function d(h,n,_){const v=h.length;let u=0,S=1,L=0;function y(I){if(_===null)u+=I;else for(;I>0;)h.charCodeAt(u)===10?(u++,S++,L=0):(u++,L++),I--}function w(I){_===null?u=I:y(I-u)}function k(){for(;u<v;){let I=h.charCodeAt(u);if(I!==32&&I!==9&&I!==13&&I!==10)break;y(1)}}function g(I){return h.substr(u,I.length)===I&&(y(I.length),!0)}function c(I){let H=h.indexOf(I,u);w(H!==-1?H+I.length:v)}function m(I){let H=h.indexOf(I,u);if(H!==-1){let $=h.substring(u,H);return w(H+I.length),$}{let $=h.substr(u);return w(v),$}}v>0&&h.charCodeAt(0)===65279&&(u=1);let f=0,o=null,e=[],s=[],i=null;function t(I,H){e.push(f),s.push(o),f=I,o=H}function a(){if(e.length===0)return l("illegal state stack");f=e.pop(),o=s.pop()}function l(I){throw new Error("Near offset "+u+": "+I+" ~~~"+h.substr(u,50)+"~~~")}const b=function(){if(i===null)return l("missing <key>");let I={};_!==null&&(I[_]={filename:n,line:S,char:L}),o[i]=I,i=null,t(1,I)},A=function(){if(i===null)return l("missing <key>");let I=[];o[i]=I,i=null,t(2,I)},P=function(){let I={};_!==null&&(I[_]={filename:n,line:S,char:L}),o.push(I),t(1,I)},E=function(){let I=[];o.push(I),t(2,I)};function N(){if(f!==1)return l("unexpected </dict>");a()}function q(){return f===1||f!==2?l("unexpected </array>"):void a()}function W(I){if(f===1){if(i===null)return l("missing <key>");o[i]=I,i=null}else f===2?o.push(I):o=I}function D(I){if(isNaN(I))return l("cannot parse float");if(f===1){if(i===null)return l("missing <key>");o[i]=I,i=null}else f===2?o.push(I):o=I}function z(I){if(isNaN(I))return l("cannot parse integer");if(f===1){if(i===null)return l("missing <key>");o[i]=I,i=null}else f===2?o.push(I):o=I}function Q(I){if(f===1){if(i===null)return l("missing <key>");o[i]=I,i=null}else f===2?o.push(I):o=I}function K(I){if(f===1){if(i===null)return l("missing <key>");o[i]=I,i=null}else f===2?o.push(I):o=I}function B(I){if(f===1){if(i===null)return l("missing <key>");o[i]=I,i=null}else f===2?o.push(I):o=I}function j(){let I=m(">"),H=!1;return I.charCodeAt(I.length-1)===47&&(H=!0,I=I.substring(0,I.length-1)),{name:I.trim(),isClosed:H}}function F(I){if(I.isClosed)return"";let H=m("</");return c(">"),H.replace(/&#([0-9]+);/g,function($,te){return String.fromCodePoint(parseInt(te,10))}).replace(/&#x([0-9a-f]+);/g,function($,te){return String.fromCodePoint(parseInt(te,16))}).replace(/&amp;|&lt;|&gt;|&quot;|&apos;/g,function($){switch($){case"&amp;":return"&";case"&lt;":return"<";case"&gt;":return">";case"&quot;":return'"';case"&apos;":return"'"}return $})}for(;u<v&&(k(),!(u>=v));){const I=h.charCodeAt(u);if(y(1),I!==60)return l("expected <");if(u>=v)return l("unexpected end of input");const H=h.charCodeAt(u);if(H===63){y(1),c("?>");continue}if(H===33){if(y(1),g("--")){c("-->");continue}c(">");continue}if(H===47){if(y(1),k(),g("plist")){c(">");continue}if(g("dict")){c(">"),N();continue}if(g("array")){c(">"),q();continue}return l("unexpected closed tag")}let $=j();switch($.name){case"dict":f===1?b():f===2?P():(o={},_!==null&&(o[_]={filename:n,line:S,char:L}),t(1,o)),$.isClosed&&N();continue;case"array":f===1?A():f===2?E():(o=[],t(2,o)),$.isClosed&&q();continue;case"key":se=F($),f!==1?l("unexpected <key>"):i!==null?l("too many <key>"):i=se;continue;case"string":W(F($));continue;case"real":D(parseFloat(F($)));continue;case"integer":z(parseInt(F($),10));continue;case"date":Q(new Date(F($)));continue;case"data":K(F($));continue;case"true":F($),B(!0);continue;case"false":F($),B(!1);continue}if(!/^plist/.test($.name))return l("unexpected opened tag "+$.name)}var se;return o}Object.defineProperty(r,"__esModule",{value:!0}),r.parsePLIST=r.parseWithLocation=void 0,r.parseWithLocation=function(h,n,_){return d(h,n,_)},r.parsePLIST=function(h){return d(h,null,null)}},652:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SyncRegistry=void 0;const h=d(391);r.SyncRegistry=class{constructor(n,_){this._onigLibPromise=_,this._grammars=new Map,this._rawGrammars=new Map,this._injectionGrammars=new Map,this._theme=n}dispose(){for(const n of this._grammars.values())n.dispose()}setTheme(n){this._theme=n}getColorMap(){return this._theme.getColorMap()}addGrammar(n,_){this._rawGrammars.set(n.scopeName,n),_&&this._injectionGrammars.set(n.scopeName,_)}lookup(n){return this._rawGrammars.get(n)}injections(n){return this._injectionGrammars.get(n)}getDefaults(){return this._theme.getDefaults()}themeMatch(n){return this._theme.match(n)}async grammarForScopeName(n,_,v,u,S){if(!this._grammars.has(n)){let L=this._rawGrammars.get(n);if(!L)return null;this._grammars.set(n,h.createGrammar(n,L,_,v,u,S,this,await this._onigLibPromise))}return this._grammars.get(n)}}},792:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.CompiledRule=r.RegExpSourceList=r.RegExpSource=r.RuleFactory=r.BeginWhileRule=r.BeginEndRule=r.IncludeOnlyRule=r.MatchRule=r.CaptureRule=r.Rule=r.ruleIdToNumber=r.ruleIdFromNumber=r.whileRuleId=r.endRuleId=void 0;const h=d(878),n=d(965),_=/\\(\d+)/,v=/\\(\d+)/g;r.endRuleId=-1,r.whileRuleId=-2,r.ruleIdFromNumber=function(o){return o},r.ruleIdToNumber=function(o){return o};class u{constructor(e,s,i,t){this.$location=e,this.id=s,this._name=i||null,this._nameIsCapturing=h.RegexSource.hasCaptures(this._name),this._contentName=t||null,this._contentNameIsCapturing=h.RegexSource.hasCaptures(this._contentName)}get debugName(){const e=this.$location?`${h.basename(this.$location.filename)}:${this.$location.line}`:"unknown";return`${this.constructor.name}#${this.id} @ ${e}`}getName(e,s){return this._nameIsCapturing&&this._name!==null&&e!==null&&s!==null?h.RegexSource.replaceCaptures(this._name,e,s):this._name}getContentName(e,s){return this._contentNameIsCapturing&&this._contentName!==null?h.RegexSource.replaceCaptures(this._contentName,e,s):this._contentName}}r.Rule=u;class S extends u{constructor(e,s,i,t,a){super(e,s,i,t),this.retokenizeCapturedWithRuleId=a}dispose(){}collectPatterns(e,s){throw new Error("Not supported!")}compile(e,s){throw new Error("Not supported!")}compileAG(e,s,i,t){throw new Error("Not supported!")}}r.CaptureRule=S;class L extends u{constructor(e,s,i,t,a){super(e,s,i,null),this._match=new c(t,this.id),this.captures=a,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugMatchRegExp(){return`${this._match.source}`}collectPatterns(e,s){s.push(this._match)}compile(e,s){return this._getCachedCompiledPatterns(e).compile(e)}compileAG(e,s,i,t){return this._getCachedCompiledPatterns(e).compileAG(e,i,t)}_getCachedCompiledPatterns(e){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new m,this.collectPatterns(e,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}}r.MatchRule=L;class y extends u{constructor(e,s,i,t,a){super(e,s,i,t),this.patterns=a.patterns,this.hasMissingPatterns=a.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}collectPatterns(e,s){for(const i of this.patterns)e.getRule(i).collectPatterns(e,s)}compile(e,s){return this._getCachedCompiledPatterns(e).compile(e)}compileAG(e,s,i,t){return this._getCachedCompiledPatterns(e).compileAG(e,i,t)}_getCachedCompiledPatterns(e){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new m,this.collectPatterns(e,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}}r.IncludeOnlyRule=y;class w extends u{constructor(e,s,i,t,a,l,b,A,P,E){super(e,s,i,t),this._begin=new c(a,this.id),this.beginCaptures=l,this._end=new c(b||"￿",-1),this.endHasBackReferences=this._end.hasBackReferences,this.endCaptures=A,this.applyEndPatternLast=P||!1,this.patterns=E.patterns,this.hasMissingPatterns=E.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugEndRegExp(){return`${this._end.source}`}getEndWithResolvedBackReferences(e,s){return this._end.resolveBackReferences(e,s)}collectPatterns(e,s){s.push(this._begin)}compile(e,s){return this._getCachedCompiledPatterns(e,s).compile(e)}compileAG(e,s,i,t){return this._getCachedCompiledPatterns(e,s).compileAG(e,i,t)}_getCachedCompiledPatterns(e,s){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new m;for(const i of this.patterns)e.getRule(i).collectPatterns(e,this._cachedCompiledPatterns);this.applyEndPatternLast?this._cachedCompiledPatterns.push(this._end.hasBackReferences?this._end.clone():this._end):this._cachedCompiledPatterns.unshift(this._end.hasBackReferences?this._end.clone():this._end)}return this._end.hasBackReferences&&(this.applyEndPatternLast?this._cachedCompiledPatterns.setSource(this._cachedCompiledPatterns.length()-1,s):this._cachedCompiledPatterns.setSource(0,s)),this._cachedCompiledPatterns}}r.BeginEndRule=w;class k extends u{constructor(e,s,i,t,a,l,b,A,P){super(e,s,i,t),this._begin=new c(a,this.id),this.beginCaptures=l,this.whileCaptures=A,this._while=new c(b,r.whileRuleId),this.whileHasBackReferences=this._while.hasBackReferences,this.patterns=P.patterns,this.hasMissingPatterns=P.hasMissingPatterns,this._cachedCompiledPatterns=null,this._cachedCompiledWhilePatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null),this._cachedCompiledWhilePatterns&&(this._cachedCompiledWhilePatterns.dispose(),this._cachedCompiledWhilePatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugWhileRegExp(){return`${this._while.source}`}getWhileWithResolvedBackReferences(e,s){return this._while.resolveBackReferences(e,s)}collectPatterns(e,s){s.push(this._begin)}compile(e,s){return this._getCachedCompiledPatterns(e).compile(e)}compileAG(e,s,i,t){return this._getCachedCompiledPatterns(e).compileAG(e,i,t)}_getCachedCompiledPatterns(e){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new m;for(const s of this.patterns)e.getRule(s).collectPatterns(e,this._cachedCompiledPatterns)}return this._cachedCompiledPatterns}compileWhile(e,s){return this._getCachedCompiledWhilePatterns(e,s).compile(e)}compileWhileAG(e,s,i,t){return this._getCachedCompiledWhilePatterns(e,s).compileAG(e,i,t)}_getCachedCompiledWhilePatterns(e,s){return this._cachedCompiledWhilePatterns||(this._cachedCompiledWhilePatterns=new m,this._cachedCompiledWhilePatterns.push(this._while.hasBackReferences?this._while.clone():this._while)),this._while.hasBackReferences&&this._cachedCompiledWhilePatterns.setSource(0,s||"￿"),this._cachedCompiledWhilePatterns}}r.BeginWhileRule=k;class g{static createCaptureRule(e,s,i,t,a){return e.registerRule(l=>new S(s,l,i,t,a))}static getCompiledRuleId(e,s,i){return e.id||s.registerRule(t=>{if(e.id=t,e.match)return new L(e.$vscodeTextmateLocation,e.id,e.name,e.match,g._compileCaptures(e.captures,s,i));if(e.begin===void 0){e.repository&&(i=h.mergeObjects({},i,e.repository));let a=e.patterns;return a===void 0&&e.include&&(a=[{include:e.include}]),new y(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,g._compilePatterns(a,s,i))}return e.while?new k(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,g._compileCaptures(e.beginCaptures||e.captures,s,i),e.while,g._compileCaptures(e.whileCaptures||e.captures,s,i),g._compilePatterns(e.patterns,s,i)):new w(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,g._compileCaptures(e.beginCaptures||e.captures,s,i),e.end,g._compileCaptures(e.endCaptures||e.captures,s,i),e.applyEndPatternLast,g._compilePatterns(e.patterns,s,i))}),e.id}static _compileCaptures(e,s,i){let t=[];if(e){let a=0;for(const l in e){if(l==="$vscodeTextmateLocation")continue;const b=parseInt(l,10);b>a&&(a=b)}for(let l=0;l<=a;l++)t[l]=null;for(const l in e){if(l==="$vscodeTextmateLocation")continue;const b=parseInt(l,10);let A=0;e[l].patterns&&(A=g.getCompiledRuleId(e[l],s,i)),t[b]=g.createCaptureRule(s,e[l].$vscodeTextmateLocation,e[l].name,e[l].contentName,A)}}return t}static _compilePatterns(e,s,i){let t=[];if(e)for(let a=0,l=e.length;a<l;a++){const b=e[a];let A=-1;if(b.include){const P=n.parseInclude(b.include);switch(P.kind){case 0:case 1:A=g.getCompiledRuleId(i[b.include],s,i);break;case 2:let E=i[P.ruleName];E&&(A=g.getCompiledRuleId(E,s,i));break;case 3:case 4:const N=P.scopeName,q=P.kind===4?P.ruleName:null,W=s.getExternalGrammar(N,i);if(W)if(q){let D=W.repository[q];D&&(A=g.getCompiledRuleId(D,s,W.repository))}else A=g.getCompiledRuleId(W.repository.$self,s,W.repository)}}else A=g.getCompiledRuleId(b,s,i);if(A!==-1){const P=s.getRule(A);let E=!1;if((P instanceof y||P instanceof w||P instanceof k)&&P.hasMissingPatterns&&P.patterns.length===0&&(E=!0),E)continue;t.push(A)}}return{patterns:t,hasMissingPatterns:(e?e.length:0)!==t.length}}}r.RuleFactory=g;class c{constructor(e,s){if(e){const i=e.length;let t=0,a=[],l=!1;for(let b=0;b<i;b++)if(e.charAt(b)==="\\"&&b+1<i){const A=e.charAt(b+1);A==="z"?(a.push(e.substring(t,b)),a.push("$(?!\\n)(?<!\\n)"),t=b+2):A!=="A"&&A!=="G"||(l=!0),b++}this.hasAnchor=l,t===0?this.source=e:(a.push(e.substring(t,i)),this.source=a.join(""))}else this.hasAnchor=!1,this.source=e;this.hasAnchor?this._anchorCache=this._buildAnchorCache():this._anchorCache=null,this.ruleId=s,this.hasBackReferences=_.test(this.source)}clone(){return new c(this.source,this.ruleId)}setSource(e){this.source!==e&&(this.source=e,this.hasAnchor&&(this._anchorCache=this._buildAnchorCache()))}resolveBackReferences(e,s){let i=s.map(t=>e.substring(t.start,t.end));return v.lastIndex=0,this.source.replace(v,(t,a)=>h.escapeRegExpCharacters(i[parseInt(a,10)]||""))}_buildAnchorCache(){let e,s,i,t,a=[],l=[],b=[],A=[];for(e=0,s=this.source.length;e<s;e++)i=this.source.charAt(e),a[e]=i,l[e]=i,b[e]=i,A[e]=i,i==="\\"&&e+1<s&&(t=this.source.charAt(e+1),t==="A"?(a[e+1]="￿",l[e+1]="￿",b[e+1]="A",A[e+1]="A"):t==="G"?(a[e+1]="￿",l[e+1]="G",b[e+1]="￿",A[e+1]="G"):(a[e+1]=t,l[e+1]=t,b[e+1]=t,A[e+1]=t),e++);return{A0_G0:a.join(""),A0_G1:l.join(""),A1_G0:b.join(""),A1_G1:A.join("")}}resolveAnchors(e,s){return this.hasAnchor&&this._anchorCache?e?s?this._anchorCache.A1_G1:this._anchorCache.A1_G0:s?this._anchorCache.A0_G1:this._anchorCache.A0_G0:this.source}}r.RegExpSource=c;class m{constructor(){this._items=[],this._hasAnchors=!1,this._cached=null,this._anchorCache={A0_G0:null,A0_G1:null,A1_G0:null,A1_G1:null}}dispose(){this._disposeCaches()}_disposeCaches(){this._cached&&(this._cached.dispose(),this._cached=null),this._anchorCache.A0_G0&&(this._anchorCache.A0_G0.dispose(),this._anchorCache.A0_G0=null),this._anchorCache.A0_G1&&(this._anchorCache.A0_G1.dispose(),this._anchorCache.A0_G1=null),this._anchorCache.A1_G0&&(this._anchorCache.A1_G0.dispose(),this._anchorCache.A1_G0=null),this._anchorCache.A1_G1&&(this._anchorCache.A1_G1.dispose(),this._anchorCache.A1_G1=null)}push(e){this._items.push(e),this._hasAnchors=this._hasAnchors||e.hasAnchor}unshift(e){this._items.unshift(e),this._hasAnchors=this._hasAnchors||e.hasAnchor}length(){return this._items.length}setSource(e,s){this._items[e].source!==s&&(this._disposeCaches(),this._items[e].setSource(s))}compile(e){if(!this._cached){let s=this._items.map(i=>i.source);this._cached=new f(e,s,this._items.map(i=>i.ruleId))}return this._cached}compileAG(e,s,i){return this._hasAnchors?s?i?(this._anchorCache.A1_G1||(this._anchorCache.A1_G1=this._resolveAnchors(e,s,i)),this._anchorCache.A1_G1):(this._anchorCache.A1_G0||(this._anchorCache.A1_G0=this._resolveAnchors(e,s,i)),this._anchorCache.A1_G0):i?(this._anchorCache.A0_G1||(this._anchorCache.A0_G1=this._resolveAnchors(e,s,i)),this._anchorCache.A0_G1):(this._anchorCache.A0_G0||(this._anchorCache.A0_G0=this._resolveAnchors(e,s,i)),this._anchorCache.A0_G0):this.compile(e)}_resolveAnchors(e,s,i){let t=this._items.map(a=>a.resolveAnchors(s,i));return new f(e,t,this._items.map(a=>a.ruleId))}}r.RegExpSourceList=m;class f{constructor(e,s,i){this.regExps=s,this.rules=i,this.scanner=e.createOnigScanner(s)}dispose(){typeof this.scanner.dispose=="function"&&this.scanner.dispose()}toString(){const e=[];for(let s=0,i=this.rules.length;s<i;s++)e.push("   - "+this.rules[s]+": "+this.regExps[s]);return e.join(`
`)}findNextMatchSync(e,s,i){const t=this.scanner.findNextMatchSync(e,s,i);return t?{ruleId:this.rules[t.index],captureIndices:t.captureIndices}:null}}r.CompiledRule=f},583:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ThemeTrieElement=r.ThemeTrieElementRule=r.ColorMap=r.fontStyleToString=r.ParsedThemeRule=r.parseTheme=r.StyleAttributes=r.ScopeStack=r.Theme=void 0;const h=d(878);class n{constructor(c,m,f){this._colorMap=c,this._defaults=m,this._root=f,this._cachedMatchRoot=new h.CachedFn(o=>this._root.match(o))}static createFromRawTheme(c,m){return this.createFromParsedTheme(S(c),m)}static createFromParsedTheme(c,m){return function(f,o){f.sort((b,A)=>{let P=h.strcmp(b.scope,A.scope);return P!==0?P:(P=h.strArrCmp(b.parentScopes,A.parentScopes),P!==0?P:b.index-A.index)});let e=0,s="#000000",i="#ffffff";for(;f.length>=1&&f[0].scope==="";){let b=f.shift();b.fontStyle!==-1&&(e=b.fontStyle),b.foreground!==null&&(s=b.foreground),b.background!==null&&(i=b.background)}let t=new y(o),a=new u(e,t.getId(s),t.getId(i)),l=new k(new w(0,null,-1,0,0),[]);for(let b=0,A=f.length;b<A;b++){let P=f[b];l.insert(0,P.scope,P.parentScopes,P.fontStyle,t.getId(P.foreground),t.getId(P.background))}return new n(t,a,l)}(c,m)}getColorMap(){return this._colorMap.getColorMap()}getDefaults(){return this._defaults}match(c){if(c===null)return this._defaults;const m=c.scopeName,f=this._cachedMatchRoot.get(m).find(o=>function(e,s){if(s===null)return!0;let i=0,t=s[i];for(;e;){if(v(e.scopeName,t)){if(i++,i===s.length)return!0;t=s[i]}e=e.parent}return!1}(c.parent,o.parentScopes));return f?new u(f.fontStyle,f.foreground,f.background):null}}r.Theme=n;class _{constructor(c,m){this.parent=c,this.scopeName=m}static push(c,m){for(const f of m)c=new _(c,f);return c}static from(...c){let m=null;for(let f=0;f<c.length;f++)m=new _(m,c[f]);return m}push(c){return new _(this,c)}getSegments(){let c=this;const m=[];for(;c;)m.push(c.scopeName),c=c.parent;return m.reverse(),m}toString(){return this.getSegments().join(" ")}extends(c){return this===c||this.parent!==null&&this.parent.extends(c)}getExtensionIfDefined(c){const m=[];let f=this;for(;f&&f!==c;)m.push(f.scopeName),f=f.parent;return f===c?m.reverse():void 0}}function v(g,c){return c===g||g.startsWith(c)&&g[c.length]==="."}r.ScopeStack=_;class u{constructor(c,m,f){this.fontStyle=c,this.foregroundId=m,this.backgroundId=f}}function S(g){if(!g)return[];if(!g.settings||!Array.isArray(g.settings))return[];let c=g.settings,m=[],f=0;for(let o=0,e=c.length;o<e;o++){let s,i=c[o];if(!i.settings)continue;if(typeof i.scope=="string"){let b=i.scope;b=b.replace(/^[,]+/,""),b=b.replace(/[,]+$/,""),s=b.split(",")}else s=Array.isArray(i.scope)?i.scope:[""];let t=-1;if(typeof i.settings.fontStyle=="string"){t=0;let b=i.settings.fontStyle.split(" ");for(let A=0,P=b.length;A<P;A++)switch(b[A]){case"italic":t|=1;break;case"bold":t|=2;break;case"underline":t|=4;break;case"strikethrough":t|=8}}let a=null;typeof i.settings.foreground=="string"&&h.isValidHexColor(i.settings.foreground)&&(a=i.settings.foreground);let l=null;typeof i.settings.background=="string"&&h.isValidHexColor(i.settings.background)&&(l=i.settings.background);for(let b=0,A=s.length;b<A;b++){let P=s[b].trim().split(" "),E=P[P.length-1],N=null;P.length>1&&(N=P.slice(0,P.length-1),N.reverse()),m[f++]=new L(E,N,o,t,a,l)}}return m}r.StyleAttributes=u,r.parseTheme=S;class L{constructor(c,m,f,o,e,s){this.scope=c,this.parentScopes=m,this.index=f,this.fontStyle=o,this.foreground=e,this.background=s}}r.ParsedThemeRule=L,r.fontStyleToString=function(g){if(g===-1)return"not set";let c="";return 1&g&&(c+="italic "),2&g&&(c+="bold "),4&g&&(c+="underline "),8&g&&(c+="strikethrough "),c===""&&(c="none"),c.trim()};class y{constructor(c){if(this._lastColorId=0,this._id2color=[],this._color2id=Object.create(null),Array.isArray(c)){this._isFrozen=!0;for(let m=0,f=c.length;m<f;m++)this._color2id[c[m]]=m,this._id2color[m]=c[m]}else this._isFrozen=!1}getId(c){if(c===null)return 0;c=c.toUpperCase();let m=this._color2id[c];if(m)return m;if(this._isFrozen)throw new Error(`Missing color in color map - ${c}`);return m=++this._lastColorId,this._color2id[c]=m,this._id2color[m]=c,m}getColorMap(){return this._id2color.slice(0)}}r.ColorMap=y;class w{constructor(c,m,f,o,e){this.scopeDepth=c,this.parentScopes=m,this.fontStyle=f,this.foreground=o,this.background=e}clone(){return new w(this.scopeDepth,this.parentScopes,this.fontStyle,this.foreground,this.background)}static cloneArr(c){let m=[];for(let f=0,o=c.length;f<o;f++)m[f]=c[f].clone();return m}acceptOverwrite(c,m,f,o){this.scopeDepth>c?console.log("how did this happen?"):this.scopeDepth=c,m!==-1&&(this.fontStyle=m),f!==0&&(this.foreground=f),o!==0&&(this.background=o)}}r.ThemeTrieElementRule=w;class k{constructor(c,m=[],f={}){this._mainRule=c,this._children=f,this._rulesWithParentScopes=m}static _sortBySpecificity(c){return c.length===1||c.sort(this._cmpBySpecificity),c}static _cmpBySpecificity(c,m){if(c.scopeDepth===m.scopeDepth){const f=c.parentScopes,o=m.parentScopes;let e=f===null?0:f.length,s=o===null?0:o.length;if(e===s)for(let i=0;i<e;i++){const t=f[i].length,a=o[i].length;if(t!==a)return a-t}return s-e}return m.scopeDepth-c.scopeDepth}match(c){if(c==="")return k._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes));let m,f,o=c.indexOf(".");return o===-1?(m=c,f=""):(m=c.substring(0,o),f=c.substring(o+1)),this._children.hasOwnProperty(m)?this._children[m].match(f):k._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes))}insert(c,m,f,o,e,s){if(m==="")return void this._doInsertHere(c,f,o,e,s);let i,t,a,l=m.indexOf(".");l===-1?(i=m,t=""):(i=m.substring(0,l),t=m.substring(l+1)),this._children.hasOwnProperty(i)?a=this._children[i]:(a=new k(this._mainRule.clone(),w.cloneArr(this._rulesWithParentScopes)),this._children[i]=a),a.insert(c+1,t,f,o,e,s)}_doInsertHere(c,m,f,o,e){if(m!==null){for(let s=0,i=this._rulesWithParentScopes.length;s<i;s++){let t=this._rulesWithParentScopes[s];if(h.strArrCmp(t.parentScopes,m)===0)return void t.acceptOverwrite(c,f,o,e)}f===-1&&(f=this._mainRule.fontStyle),o===0&&(o=this._mainRule.foreground),e===0&&(e=this._mainRule.background),this._rulesWithParentScopes.push(new w(c,m,f,o,e))}else this._mainRule.acceptOverwrite(c,f,o,e)}}r.ThemeTrieElement=k},878:(C,r)=>{function d(_){return Array.isArray(_)?function(v){let u=[];for(let S=0,L=v.length;S<L;S++)u[S]=d(v[S]);return u}(_):typeof _=="object"?function(v){let u={};for(let S in v)u[S]=d(v[S]);return u}(_):_}Object.defineProperty(r,"__esModule",{value:!0}),r.performanceNow=r.CachedFn=r.escapeRegExpCharacters=r.isValidHexColor=r.strArrCmp=r.strcmp=r.RegexSource=r.basename=r.mergeObjects=r.clone=void 0,r.clone=function(_){return d(_)},r.mergeObjects=function(_,...v){return v.forEach(u=>{for(let S in u)_[S]=u[S]}),_},r.basename=function _(v){const u=~v.lastIndexOf("/")||~v.lastIndexOf("\\");return u===0?v:~u==v.length-1?_(v.substring(0,v.length-1)):v.substr(1+~u)};let h=/\$(\d+)|\${(\d+):\/(downcase|upcase)}/g;function n(_,v){return _<v?-1:_>v?1:0}r.RegexSource=class{static hasCaptures(_){return _!==null&&(h.lastIndex=0,h.test(_))}static replaceCaptures(_,v,u){return _.replace(h,(S,L,y,w)=>{let k=u[parseInt(L||y,10)];if(!k)return S;{let g=v.substring(k.start,k.end);for(;g[0]===".";)g=g.substring(1);switch(w){case"downcase":return g.toLowerCase();case"upcase":return g.toUpperCase();default:return g}}})}},r.strcmp=n,r.strArrCmp=function(_,v){if(_===null&&v===null)return 0;if(!_)return-1;if(!v)return 1;let u=_.length,S=v.length;if(u===S){for(let L=0;L<u;L++){let y=n(_[L],v[L]);if(y!==0)return y}return 0}return u-S},r.isValidHexColor=function(_){return!!(/^#[0-9a-f]{6}$/i.test(_)||/^#[0-9a-f]{8}$/i.test(_)||/^#[0-9a-f]{3}$/i.test(_)||/^#[0-9a-f]{4}$/i.test(_))},r.escapeRegExpCharacters=function(_){return _.replace(/[\-\\\{\}\*\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&")},r.CachedFn=class{constructor(_){this.fn=_,this.cache=new Map}get(_){if(this.cache.has(_))return this.cache.get(_);const v=this.fn(_);return this.cache.set(_,v),v}},r.performanceNow=typeof performance>"u"?function(){return Date.now()}:function(){return performance.now()}}},x={};return function C(r){var d=x[r];if(d!==void 0)return d.exports;var h=x[r]={exports:{}};return R[r].call(h.exports,h,h.exports,C),h.exports}(787)})()})})(tt);var Ce=tt.exports;const Ht=We(Ce),Kt=et({__proto__:null,default:Ht},[Ce]);class Me extends be{static{this._id=0}constructor(p,T,R,x,C,r){super(),this._model=p,this._worker=T,this._languageIdCodec=R,this._backgroundTokenizationStore=x,this._configurationService=C,this._maxTokenizationLineLength=r,this.controllerId=Me._id++,this._pendingChanges=[],this._states=new ut,this._loggingEnabled=Qt("editor.experimental.asyncTokenizationLogging",!1,this._configurationService),this._register(Be(this._loggingEnabled)),this._register(this._model.onDidChangeContent(n=>{this._shouldLog&&console.log("model change",{fileName:this._model.uri.fsPath.split("\\").pop(),changes:Le(n.changes)}),this._worker.acceptModelChanged(this.controllerId,n),this._pendingChanges.push(n)})),this._register(this._model.onDidChangeLanguage(n=>{const _=this._model.getLanguageId(),v=this._languageIdCodec.encodeLanguageId(_);this._worker.acceptModelLanguageChanged(this.controllerId,_,v)}));const d=this._model.getLanguageId(),h=this._languageIdCodec.encodeLanguageId(d);this._worker.acceptNewModel({uri:this._model.uri,versionId:this._model.getVersionId(),lines:this._model.getLinesContent(),EOL:this._model.getEOL(),languageId:d,encodedLanguageId:h,maxTokenizationLineLength:this._maxTokenizationLineLength.get(),controllerId:this.controllerId}),this._register(lt(n=>{const _=this._maxTokenizationLineLength.read(n);this._worker.acceptMaxTokenizationLineLength(this.controllerId,_)}))}dispose(){super.dispose(),this._worker.acceptRemovedModel(this.controllerId)}requestTokens(p,T){this._worker.retokenize(this.controllerId,p,T)}async setTokensAndStates(p,T,R,x){if(this.controllerId!==p)return;let C=Ge.deserialize(new Uint8Array(R));if(this._shouldLog&&console.log("received background tokenization result",{fileName:this._model.uri.fsPath.split("\\").pop(),updatedTokenLines:C.map(d=>d.getLineRange()).join(" & "),updatedStateLines:x.map(d=>new ht(d.startLineNumber,d.startLineNumber+d.stateDeltas.length).toString()).join(" & ")}),this._shouldLog){const d=this._pendingChanges.filter(h=>h.versionId<=T).map(h=>h.changes).map(h=>Le(h)).join(" then ");console.log("Applying changes to local states",d)}for(;this._pendingChanges.length>0&&this._pendingChanges[0].versionId<=T;){const d=this._pendingChanges.shift();this._states.acceptChanges(d.changes)}if(this._pendingChanges.length>0){if(this._shouldLog){const n=this._pendingChanges.map(_=>_.changes).map(_=>Le(_)).join(" then ");console.log("Considering non-processed changes",n)}const d=we.fromMany(this._pendingChanges.map(n=>je(n.changes))),h=new Ge;for(const n of C)for(let _=n.startLineNumber;_<=n.endLineNumber;_++)d.transform(_-1)!==void 0&&h.add(_,n.getLineTokens(_));C=h.finalize();for(const n of this._pendingChanges)for(const _ of n.changes)for(let v=0;v<C.length;v++)C[v].applyEdit(_.range,_.text)}const r=we.fromMany(this._pendingChanges.map(d=>je(d.changes)));(!this._applyStateStackDiffFn||!this._initialState)&&(this._applyStateStackDiffFn=Ce.applyStateStackDiff,this._initialState=Ce.INITIAL);for(const d of x){let h=d.startLineNumber<=1?this._initialState:this._states.getEndState(d.startLineNumber-1);for(let n=0;n<d.stateDeltas.length;n++){const _=d.stateDeltas[n];let v;_?(v=this._applyStateStackDiffFn(h,_),this._states.setEndState(d.startLineNumber+n,v)):v=this._states.getEndState(d.startLineNumber+n);const u=r.transform(d.startLineNumber+n-1);u!==void 0&&this._backgroundTokenizationStore.setEndState(u+1,v),d.startLineNumber+n>=this._model.getLineCount()-1&&this._backgroundTokenizationStore.backgroundTokenizationFinished(),h=v}}this._backgroundTokenizationStore.setTokens(C)}get _shouldLog(){return this._loggingEnabled.get()}}function je(O){return new Ut(O.map(p=>new qt(p.range.startLineNumber-1,p.range.endLineNumber-p.range.startLineNumber+1,dt(p.text)[0]+1)))}function Le(O){return O.map(p=>pt.lift(p.range).toString()+" => "+p.text).join(" & ")}function Qt(O,p,T){return Ue(R=>T.onDidChangeConfiguration(x=>{x.affectsConfiguration(O)&&R(x)}),()=>T.getValue(O)??p)}var Se;let Ie=class{static{Se=this}static{this._reportedMismatchingTokens=!1}constructor(p,T,R,x,C,r,d,h,n,_){this._reportTokenizationTime=p,this._shouldTokenizeAsync=T,this._extensionResourceLoaderService=R,this._modelService=x,this._languageConfigurationService=C,this._configurationService=r,this._languageService=d,this._environmentService=h,this._notificationService=n,this._telemetryService=_,this._workerProxyPromise=null,this._worker=null,this._workerProxy=null,this._workerTokenizerControllers=new Map,this._currentTheme=null,this._currentTokenColorMap=null,this._grammarDefinitions=[]}dispose(){this._disposeWorker()}createBackgroundTokenizer(p,T,R){if(!this._shouldTokenizeAsync()||p.isTooLargeForSyncing())return;const x=new ve,C=this._getWorkerProxy().then(r=>{if(x.isDisposed||!r)return;const d={controller:void 0,worker:this._worker};return x.add(Jt(p,()=>{const h=new Me(p,r,this._languageService.languageIdCodec,T,this._configurationService,R);return d.controller=h,this._workerTokenizerControllers.set(h.controllerId,h),mt(()=>{d.controller=void 0,this._workerTokenizerControllers.delete(h.controllerId),h.dispose()})})),d});return{dispose(){x.dispose()},requestTokens:async(r,d)=>{const h=await C;h?.controller&&h.worker===this._worker&&h.controller.requestTokens(r,d)},reportMismatchingTokens:r=>{Se._reportedMismatchingTokens||(Se._reportedMismatchingTokens=!0,this._notificationService.error({message:"Async Tokenization Token Mismatch in line "+r,name:"Async Tokenization Token Mismatch"}),this._telemetryService.publicLog2("asyncTokenizationMismatchingTokens",{}))}}}setGrammarDefinitions(p){this._grammarDefinitions=p,this._disposeWorker()}acceptTheme(p,T){this._currentTheme=p,this._currentTokenColorMap=T,this._currentTheme&&this._currentTokenColorMap&&this._workerProxy&&this._workerProxy.acceptTheme(this._currentTheme,this._currentTokenColorMap)}_getWorkerProxy(){return this._workerProxyPromise||(this._workerProxyPromise=this._createWorkerProxy()),this._workerProxyPromise}async _createWorkerProxy(){const p=`${Ae}/vscode-textmate`,T=`${De}/vscode-textmate`,R=`${Ae}/vscode-oniguruma`,x=`${De}/vscode-oniguruma`,C=this._environmentService.isBuilt&&!qe,r=C?T:p,d=C?x:R,h=`${r}/release/main.js`,n=`${d}/release/main.js`,_=`${d}/release/onig.wasm`,v=ke.asBrowserUri(h).toString(!0),u={grammarDefinitions:this._grammarDefinitions,textmateMainUri:v,onigurumaMainUri:ke.asBrowserUri(n).toString(!0),onigurumaWASMUri:ke.asBrowserUri(_).toString(!0)},S={readFile:async w=>{const k=ft.revive(w);return this._extensionResourceLoaderService.readExtensionResource(k)},setTokensAndStates:async(w,k,g,c)=>{const m=this._workerTokenizerControllers.get(w);m&&m.setTokensAndStates(w,k,g,c)},reportTokenizationTime:(w,k,g,c,m)=>{this._reportTokenizationTime(w,k,g,c,m)}},L=this._worker=gt(this._modelService,this._languageConfigurationService,{createData:u,label:"textMateWorker",moduleId:"vs/workbench/services/textMate/browser/backgroundTokenization/worker/textMateTokenizationWorker.worker",host:S}),y=await L.getProxy();return this._worker!==L?null:(this._workerProxy=y,this._currentTheme&&this._currentTokenColorMap&&this._workerProxy.acceptTheme(this._currentTheme,this._currentTokenColorMap),y)}_disposeWorker(){for(const p of this._workerTokenizerControllers.values())p.dispose();this._workerTokenizerControllers.clear(),this._worker&&(this._worker.dispose(),this._worker=null),this._workerProxy=null,this._workerProxyPromise=null}};Ie=Se=Pe([Z(2,Ve),Z(3,_t),Z(4,kt),Z(5,He),Z(6,Ke),Z(7,yt),Z(8,Qe),Z(9,Je)],Ie);function Jt(O,p){const T=new ve,R=T.add(new ve);function x(){O.isAttachedToEditor()?R.add(p()):R.clear()}return x(),T.add(O.onDidChangeAttached(()=>{x()})),T}class Xt{constructor(){this._scopeNameToLanguageRegistration=Object.create(null)}reset(){this._scopeNameToLanguageRegistration=Object.create(null)}register(p){this._scopeNameToLanguageRegistration[p.scopeName]=p}getGrammarDefinition(p){return this._scopeNameToLanguageRegistration[p]||null}}const Te="No TM Grammar registered for this language.";class Yt extends be{constructor(p,T,R,x){super(),this._host=p,this._initialState=R.INITIAL,this._scopeRegistry=new Xt,this._injections={},this._injectedEmbeddedLanguages={},this._languageToScope=new Map,this._grammarRegistry=this._register(new R.Registry({onigLib:x,loadGrammar:async C=>{const r=this._scopeRegistry.getGrammarDefinition(C);if(!r)return this._host.logTrace(`No grammar found for scope ${C}`),null;const d=r.location;try{const h=await this._host.readFile(d);return R.parseRawGrammar(h,d.path)}catch(h){return this._host.logError(`Unable to load and parse grammar for scope ${C} from ${d}`,h),null}},getInjections:C=>{const r=C.split(".");let d=[];for(let h=1;h<=r.length;h++){const n=r.slice(0,h).join(".");d=[...d,...this._injections[n]||[]]}return d}}));for(const C of T){if(this._scopeRegistry.register(C),C.injectTo){for(const r of C.injectTo){let d=this._injections[r];d||(this._injections[r]=d=[]),d.push(C.scopeName)}if(C.embeddedLanguages)for(const r of C.injectTo){let d=this._injectedEmbeddedLanguages[r];d||(this._injectedEmbeddedLanguages[r]=d=[]),d.push(C.embeddedLanguages)}}C.language&&this._languageToScope.set(C.language,C.scopeName)}}has(p){return this._languageToScope.has(p)}setTheme(p,T){this._grammarRegistry.setTheme(p,T)}getColorMap(){return this._grammarRegistry.getColorMap()}async createGrammar(p,T){const R=this._languageToScope.get(p);if(typeof R!="string")throw new Error(Te);const x=this._scopeRegistry.getGrammarDefinition(R);if(!x)throw new Error(Te);const C=x.embeddedLanguages;if(this._injectedEmbeddedLanguages[R]){const h=this._injectedEmbeddedLanguages[R];for(const n of h)for(const _ of Object.keys(n))C[_]=n[_]}const r=Object.keys(C).length>0;let d;try{d=await this._grammarRegistry.loadGrammarWithConfiguration(R,T,{embeddedLanguages:C,tokenTypes:x.tokenTypes,balancedBracketSelectors:x.balancedBracketSelectors,unbalancedBracketSelectors:x.unbalancedBracketSelectors})}catch(h){throw h.message&&h.message.startsWith("No grammar provided for")?new Error(Te):h}return{languageId:p,grammar:d,initialState:this._initialState,containsEmbeddedLanguages:r,sourceExtensionId:x.sourceExtensionId}}}const ae=bt.registerExtensionPoint({extensionPoint:"grammars",deps:[St],jsonSchema:{description:X("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars","Contributes textmate tokenizers."),type:"array",defaultSnippets:[{body:[{language:"${1:id}",scopeName:"source.${2:id}",path:"./syntaxes/${3:id}.tmLanguage."}]}],items:{type:"object",defaultSnippets:[{body:{language:"${1:id}",scopeName:"source.${2:id}",path:"./syntaxes/${3:id}.tmLanguage."}}],properties:{language:{description:X("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars.language","Language identifier for which this syntax is contributed to."),type:"string"},scopeName:{description:X("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars.scopeName","Textmate scope name used by the tmLanguage file."),type:"string"},path:{description:X("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars.path","Path of the tmLanguage file. The path is relative to the extension folder and typically starts with './syntaxes/'."),type:"string"},embeddedLanguages:{description:X("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars.embeddedLanguages","A map of scope name to language id if this grammar contains embedded languages."),type:"object"},tokenTypes:{description:X("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars.tokenTypes","A map of scope name to token types."),type:"object",additionalProperties:{enum:["string","comment","other"]}},injectTo:{description:X("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars.injectTo","List of language scope names to which this grammar is injected to."),type:"array",items:{type:"string"}},balancedBracketScopes:{description:X("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars.balancedBracketScopes","Defines which scope names contain balanced brackets."),type:"array",items:{type:"string"},default:["*"]},unbalancedBracketScopes:{description:X("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars.unbalancedBracketScopes","Defines which scope names do not contain balanced brackets."),type:"array",items:{type:"string"},default:[]}},required:["scopeName","path"]}}});var nt={exports:{}};(function(O,p){(function(T,R){O.exports=R()})($e,()=>{return T={770:function(x,C,r){var d=this&&this.__importDefault||function(w){return w&&w.__esModule?w:{default:w}};Object.defineProperty(C,"__esModule",{value:!0}),C.setDefaultDebugCall=C.createOnigScanner=C.createOnigString=C.loadWASM=C.OnigScanner=C.OnigString=void 0;const h=d(r(418));let n=null,_=!1;class v{static _utf8ByteLength(k){let g=0;for(let c=0,m=k.length;c<m;c++){const f=k.charCodeAt(c);let o=f,e=!1;if(f>=55296&&f<=56319&&c+1<m){const s=k.charCodeAt(c+1);s>=56320&&s<=57343&&(o=65536+(f-55296<<10)|s-56320,e=!0)}g+=o<=127?1:o<=2047?2:o<=65535?3:4,e&&c++}return g}constructor(k){const g=k.length,c=v._utf8ByteLength(k),m=c!==g,f=m?new Uint32Array(g+1):null;m&&(f[g]=c);const o=m?new Uint32Array(c+1):null;m&&(o[c]=g);const e=new Uint8Array(c);let s=0;for(let i=0;i<g;i++){const t=k.charCodeAt(i);let a=t,l=!1;if(t>=55296&&t<=56319&&i+1<g){const b=k.charCodeAt(i+1);b>=56320&&b<=57343&&(a=65536+(t-55296<<10)|b-56320,l=!0)}m&&(f[i]=s,l&&(f[i+1]=s),a<=127?o[s+0]=i:a<=2047?(o[s+0]=i,o[s+1]=i):a<=65535?(o[s+0]=i,o[s+1]=i,o[s+2]=i):(o[s+0]=i,o[s+1]=i,o[s+2]=i,o[s+3]=i)),a<=127?e[s++]=a:a<=2047?(e[s++]=192|(1984&a)>>>6,e[s++]=128|(63&a)>>>0):a<=65535?(e[s++]=224|(61440&a)>>>12,e[s++]=128|(4032&a)>>>6,e[s++]=128|(63&a)>>>0):(e[s++]=240|(1835008&a)>>>18,e[s++]=128|(258048&a)>>>12,e[s++]=128|(4032&a)>>>6,e[s++]=128|(63&a)>>>0),l&&i++}this.utf16Length=g,this.utf8Length=c,this.utf16Value=k,this.utf8Value=e,this.utf16OffsetToUtf8=f,this.utf8OffsetToUtf16=o}createString(k){const g=k._omalloc(this.utf8Length);return k.HEAPU8.set(this.utf8Value,g),g}}class u{constructor(k){if(this.id=++u.LAST_ID,!n)throw new Error("Must invoke loadWASM first.");this._onigBinding=n,this.content=k;const g=new v(k);this.utf16Length=g.utf16Length,this.utf8Length=g.utf8Length,this.utf16OffsetToUtf8=g.utf16OffsetToUtf8,this.utf8OffsetToUtf16=g.utf8OffsetToUtf16,this.utf8Length<1e4&&!u._sharedPtrInUse?(u._sharedPtr||(u._sharedPtr=n._omalloc(1e4)),u._sharedPtrInUse=!0,n.HEAPU8.set(g.utf8Value,u._sharedPtr),this.ptr=u._sharedPtr):this.ptr=g.createString(n)}convertUtf8OffsetToUtf16(k){return this.utf8OffsetToUtf16?k<0?0:k>this.utf8Length?this.utf16Length:this.utf8OffsetToUtf16[k]:k}convertUtf16OffsetToUtf8(k){return this.utf16OffsetToUtf8?k<0?0:k>this.utf16Length?this.utf8Length:this.utf16OffsetToUtf8[k]:k}dispose(){this.ptr===u._sharedPtr?u._sharedPtrInUse=!1:this._onigBinding._ofree(this.ptr)}}C.OnigString=u,u.LAST_ID=0,u._sharedPtr=0,u._sharedPtrInUse=!1;class S{constructor(k){if(!n)throw new Error("Must invoke loadWASM first.");const g=[],c=[];for(let e=0,s=k.length;e<s;e++){const i=new v(k[e]);g[e]=i.createString(n),c[e]=i.utf8Length}const m=n._omalloc(4*k.length);n.HEAPU32.set(g,m/4);const f=n._omalloc(4*k.length);n.HEAPU32.set(c,f/4);const o=n._createOnigScanner(m,f,k.length);for(let e=0,s=k.length;e<s;e++)n._ofree(g[e]);n._ofree(f),n._ofree(m),o===0&&function(e){throw new Error(e.UTF8ToString(e._getLastOnigError()))}(n),this._onigBinding=n,this._ptr=o}dispose(){this._onigBinding._freeOnigScanner(this._ptr)}findNextMatchSync(k,g,c){let m=_,f=0;if(typeof c=="number"?(8&c&&(m=!0),f=c):typeof c=="boolean"&&(m=c),typeof k=="string"){k=new u(k);const o=this._findNextMatchSync(k,g,m,f);return k.dispose(),o}return this._findNextMatchSync(k,g,m,f)}_findNextMatchSync(k,g,c,m){const f=this._onigBinding;let o;if(o=c?f._findNextOnigScannerMatchDbg(this._ptr,k.id,k.ptr,k.utf8Length,k.convertUtf16OffsetToUtf8(g),m):f._findNextOnigScannerMatch(this._ptr,k.id,k.ptr,k.utf8Length,k.convertUtf16OffsetToUtf8(g),m),o===0)return null;const e=f.HEAPU32;let s=o/4;const i=e[s++],t=e[s++];let a=[];for(let l=0;l<t;l++){const b=k.convertUtf8OffsetToUtf16(e[s++]),A=k.convertUtf8OffsetToUtf16(e[s++]);a[l]={start:b,end:A,length:A-b}}return{index:i,captureIndices:a}}}C.OnigScanner=S;let L=!1,y=null;C.loadWASM=function(w){if(L)return y;let k,g,c,m;if(L=!0,function(f){return typeof f.instantiator=="function"}(w))k=w.instantiator,g=w.print;else{let f;(function(o){return o.data!==void 0})(w)?(f=w.data,g=w.print):f=w,k=function(o){return typeof Response<"u"&&o instanceof Response}(f)?typeof WebAssembly.instantiateStreaming=="function"?function(o){return e=>WebAssembly.instantiateStreaming(o,e)}(f):function(o){return async e=>{const s=await o.arrayBuffer();return WebAssembly.instantiate(s,e)}}(f):function(o){return e=>WebAssembly.instantiate(o,e)}(f)}return y=new Promise((f,o)=>{c=f,m=o}),function(f,o,e,s){(0,h.default)({print:o,instantiateWasm:(i,t)=>{if(typeof performance>"u"){const a=()=>Date.now();i.env.emscripten_get_now=a,i.wasi_snapshot_preview1.emscripten_get_now=a}return f(i).then(a=>t(a.instance),s),{}}}).then(i=>{n=i,e()})}(k,g,c,m),y},C.createOnigString=function(w){return new u(w)},C.createOnigScanner=function(w){return new S(w)},C.setDefaultDebugCall=function(w){_=w}},418:x=>{var C=(typeof document<"u"&&document.currentScript&&document.currentScript.src,function(r){var d,h,n=(r=r||{})!==void 0?r:{};n.ready=new Promise(function(M,G){d=M,h=G});var _,v=Object.assign({},n),u=!1,S="";function L(M){return n.locateFile?n.locateFile(M,S):S+M}_=function(M){let G;return typeof readbuffer=="function"?new Uint8Array(readbuffer(M)):(G=read(M,"binary"),m(typeof G=="object"),G)},typeof scriptArgs<"u"&&scriptArgs,typeof onig_print<"u"&&(typeof console>"u"&&(console={}),console.log=onig_print,console.warn=console.error=typeof printErr<"u"?printErr:onig_print);var y,w,k=n.print||console.log.bind(console),g=n.printErr||console.warn.bind(console);Object.assign(n,v),v=null,n.arguments&&n.arguments,n.thisProgram&&n.thisProgram,n.quit&&n.quit,n.wasmBinary&&(y=n.wasmBinary),n.noExitRuntime,typeof WebAssembly!="object"&&j("no native wasm support detected");var c=!1;function m(M,G){M||j(G)}var f,o,e,s=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function i(M,G,J){for(var re=G+J,U=G;M[U]&&!(U>=re);)++U;if(U-G>16&&M.buffer&&s)return s.decode(M.subarray(G,U));for(var V="";G<U;){var Y=M[G++];if(128&Y){var ie=63&M[G++];if((224&Y)!=192){var me=63&M[G++];if((Y=(240&Y)==224?(15&Y)<<12|ie<<6|me:(7&Y)<<18|ie<<12|me<<6|63&M[G++])<65536)V+=String.fromCharCode(Y);else{var Ne=Y-65536;V+=String.fromCharCode(55296|Ne>>10,56320|1023&Ne)}}else V+=String.fromCharCode((31&Y)<<6|ie)}else V+=String.fromCharCode(Y)}return V}function t(M,G){return M?i(o,M,G):""}function a(M){f=M,n.HEAP8=new Int8Array(M),n.HEAP16=new Int16Array(M),n.HEAP32=new Int32Array(M),n.HEAPU8=o=new Uint8Array(M),n.HEAPU16=new Uint16Array(M),n.HEAPU32=e=new Uint32Array(M),n.HEAPF32=new Float32Array(M),n.HEAPF64=new Float64Array(M)}n.INITIAL_MEMORY;var l=[],b=[],A=[];function P(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)q(n.preRun.shift());ue(l)}function E(){ue(b)}function N(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)D(n.postRun.shift());ue(A)}function q(M){l.unshift(M)}function W(M){b.unshift(M)}function D(M){A.unshift(M)}var z=0,Q=null;function K(M){z++,n.monitorRunDependencies&&n.monitorRunDependencies(z)}function B(M){if(z--,n.monitorRunDependencies&&n.monitorRunDependencies(z),z==0&&Q){var G=Q;Q=null,G()}}function j(M){n.onAbort&&n.onAbort(M),g(M="Aborted("+M+")"),c=!0,M+=". Build with -sASSERTIONS for more info.";var G=new WebAssembly.RuntimeError(M);throw h(G),G}var F,se,I="data:application/octet-stream;base64,";function H(M){return M.startsWith(I)}function $(M){try{if(M==F&&y)return new Uint8Array(y);if(_)return _(M);throw"both async and sync fetching of the wasm failed"}catch(G){j(G)}}function te(){return y||!u||typeof fetch!="function"?Promise.resolve().then(function(){return $(F)}):fetch(F,{credentials:"same-origin"}).then(function(M){if(!M.ok)throw"failed to load wasm binary file at '"+F+"'";return M.arrayBuffer()}).catch(function(){return $(F)})}function ce(){var M={env:ee,wasi_snapshot_preview1:ee};function G(U,V){var Y=U.exports;n.asm=Y,a((w=n.asm.memory).buffer),n.asm.__indirect_function_table,W(n.asm.__wasm_call_ctors),B()}function J(U){G(U.instance)}function re(U){return te().then(function(V){return WebAssembly.instantiate(V,M)}).then(function(V){return V}).then(U,function(V){g("failed to asynchronously prepare wasm: "+V),j(V)})}if(K(),n.instantiateWasm)try{return n.instantiateWasm(M,G)}catch(U){g("Module.instantiateWasm callback failed with error: "+U),h(U)}return(y||typeof WebAssembly.instantiateStreaming!="function"||H(F)||typeof fetch!="function"?re(J):fetch(F,{credentials:"same-origin"}).then(function(U){return WebAssembly.instantiateStreaming(U,M).then(J,function(V){return g("wasm streaming compile failed: "+V),g("falling back to ArrayBuffer instantiation"),re(J)})})).catch(h),{}}function ue(M){for(;M.length>0;)M.shift()(n)}function le(M,G,J){o.copyWithin(M,G,G+J)}function oe(M){try{return w.grow(M-f.byteLength+65535>>>16),a(w.buffer),1}catch{}}function fe(M){var G,J=o.length,re=2147483648;if((M>>>=0)>re)return!1;for(var U=1;U<=4;U*=2){var V=J*(1+.2/U);if(V=Math.min(V,M+100663296),oe(Math.min(re,(G=Math.max(M,V))+(65536-G%65536)%65536)))return!0}return!1}H(F="onig.wasm")||(F=L(F)),se=typeof dateNow<"u"?dateNow:()=>performance.now();var he=[null,[],[]];function de(M,G){var J=he[M];G===0||G===10?((M===1?k:g)(i(J,0)),J.length=0):J.push(G)}function pe(M,G,J,re){for(var U=0,V=0;V<J;V++){var Y=e[G>>2],ie=e[G+4>>2];G+=8;for(var me=0;me<ie;me++)de(M,o[Y+me]);U+=ie}return e[re>>2]=U,0}var ne,ee={emscripten_get_now:se,emscripten_memcpy_big:le,emscripten_resize_heap:fe,fd_write:pe};function ge(M){function G(){ne||(ne=!0,n.calledRun=!0,c||(E(),d(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),N()))}z>0||(P(),z>0||(n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),G()},1)):G()))}if(ce(),n.___wasm_call_ctors=function(){return(n.___wasm_call_ctors=n.asm.__wasm_call_ctors).apply(null,arguments)},n.___errno_location=function(){return(n.___errno_location=n.asm.__errno_location).apply(null,arguments)},n._omalloc=function(){return(n._omalloc=n.asm.omalloc).apply(null,arguments)},n._ofree=function(){return(n._ofree=n.asm.ofree).apply(null,arguments)},n._getLastOnigError=function(){return(n._getLastOnigError=n.asm.getLastOnigError).apply(null,arguments)},n._createOnigScanner=function(){return(n._createOnigScanner=n.asm.createOnigScanner).apply(null,arguments)},n._freeOnigScanner=function(){return(n._freeOnigScanner=n.asm.freeOnigScanner).apply(null,arguments)},n._findNextOnigScannerMatch=function(){return(n._findNextOnigScannerMatch=n.asm.findNextOnigScannerMatch).apply(null,arguments)},n._findNextOnigScannerMatchDbg=function(){return(n._findNextOnigScannerMatchDbg=n.asm.findNextOnigScannerMatchDbg).apply(null,arguments)},n.stackSave=function(){return(n.stackSave=n.asm.stackSave).apply(null,arguments)},n.stackRestore=function(){return(n.stackRestore=n.asm.stackRestore).apply(null,arguments)},n.stackAlloc=function(){return(n.stackAlloc=n.asm.stackAlloc).apply(null,arguments)},n.dynCall_jiji=function(){return(n.dynCall_jiji=n.asm.dynCall_jiji).apply(null,arguments)},n.UTF8ToString=t,Q=function M(){ne||ge(),ne||(Q=M)},n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return ge(),r.ready});x.exports=C}},R={},function x(C){var r=R[C];if(r!==void 0)return r.exports;var d=R[C]={exports:{}};return T[C].call(d.exports,d,d.exports,x),d.exports}(770);var T,R})})(nt);var Ee=nt.exports;const Zt=We(Ee),en=et({__proto__:null,default:Zt},[Ee]);var _e;let xe=class extends be{static{_e=this}static{this.reportTokenizationTimeCounter={sync:0,async:0}}constructor(p,T,R,x,C,r,d,h,n,_){super(),this._languageService=p,this._themeService=T,this._extensionResourceLoaderService=R,this._notificationService=x,this._logService=C,this._configurationService=r,this._progressService=d,this._environmentService=h,this._instantiationService=n,this._telemetryService=_,this._createdModes=[],this._encounteredLanguages=[],this._debugMode=!1,this._debugModePrintFunc=()=>{},this._grammarDefinitions=null,this._grammarFactory=null,this._tokenizersRegistrations=new ve,this._currentTheme=null,this._currentTokenColorMap=null,this._threadedBackgroundTokenizerFactory=this._instantiationService.createInstance(Ie,(v,u,S,L,y)=>this._reportTokenizationTime(v,u,S,L,!0,y),()=>this.getAsyncTokenizationEnabled()),this._vscodeOniguruma=null,this._styleElement=Tt(),this._styleElement.className="vscode-tokens-styles",ae.setHandler(v=>this._handleGrammarsExtPoint(v)),this._updateTheme(this._themeService.getColorTheme(),!0),this._register(this._themeService.onDidColorThemeChange(()=>{this._updateTheme(this._themeService.getColorTheme(),!1)})),this._languageService.onDidRequestRichLanguageFeatures(v=>{this._createdModes.push(v)})}getAsyncTokenizationEnabled(){return!!this._configurationService.getValue("editor.experimental.asyncTokenization")}getAsyncTokenizationVerification(){return!!this._configurationService.getValue("editor.experimental.asyncTokenizationVerification")}_handleGrammarsExtPoint(p){this._grammarDefinitions=null,this._grammarFactory&&(this._grammarFactory.dispose(),this._grammarFactory=null),this._tokenizersRegistrations.clear(),this._grammarDefinitions=[];for(const T of p){const R=T.value;for(const x of R){const C=this._validateGrammarDefinition(T,x);if(C&&(this._grammarDefinitions.push(C),C.language)){const r=new It(()=>this._createTokenizationSupport(C.language));this._tokenizersRegistrations.add(r),this._tokenizersRegistrations.add(Re.registerFactory(C.language,r))}}}this._threadedBackgroundTokenizerFactory.setGrammarDefinitions(this._grammarDefinitions);for(const T of this._createdModes)Re.getOrCreate(T)}_validateGrammarDefinition(p,T){if(!rn(p.description.extensionLocation,T,p.collector,this._languageService))return null;const R=Xe(p.description.extensionLocation,T.path),x=Object.create(null);if(T.embeddedLanguages){const h=Object.keys(T.embeddedLanguages);for(let n=0,_=h.length;n<_;n++){const v=h[n],u=T.embeddedLanguages[v];typeof u=="string"&&this._languageService.isRegisteredLanguageId(u)&&(x[v]=this._languageService.languageIdCodec.encodeLanguageId(u))}}const C=Object.create(null);if(T.tokenTypes){const h=Object.keys(T.tokenTypes);for(const n of h)switch(T.tokenTypes[n]){case"string":C[n]=2;break;case"other":C[n]=0;break;case"comment":C[n]=1;break}}const r=T.language&&this._languageService.isRegisteredLanguageId(T.language)?T.language:null;function d(h,n){return!Array.isArray(h)||!h.every(_=>typeof _=="string")?n:h}return{location:R,language:r||void 0,scopeName:T.scopeName,embeddedLanguages:x,tokenTypes:C,injectTo:T.injectTo,balancedBracketSelectors:d(T.balancedBracketScopes,["*"]),unbalancedBracketSelectors:d(T.unbalancedBracketScopes,[]),sourceExtensionId:p.description.id}}startDebugMode(p,T){if(this._debugMode){this._notificationService.error(X("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","alreadyDebugging","Already Logging."));return}this._debugModePrintFunc=p,this._debugMode=!0,this._debugMode&&this._progressService.withProgress({location:15,buttons:[X("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","stop","Stop")]},R=>(R.report({message:X("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","progress1","Preparing to log TM Grammar parsing. Press Stop when finished.")}),this._getVSCodeOniguruma().then(x=>(x.setDefaultDebugCall(!0),R.report({message:X("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","progress2","Now logging TM Grammar parsing. Press Stop when finished.")}),new Promise((C,r)=>{})))),R=>{this._getVSCodeOniguruma().then(x=>{this._debugModePrintFunc=()=>{},this._debugMode=!1,x.setDefaultDebugCall(!1),T()})})}_canCreateGrammarFactory(){return!!this._grammarDefinitions}async _getOrCreateGrammarFactory(){if(this._grammarFactory)return this._grammarFactory;const p=await this._getVSCodeOniguruma(),T=Promise.resolve({createOnigScanner:R=>p.createOnigScanner(R),createOnigString:R=>p.createOnigString(R)});return this._grammarFactory?this._grammarFactory:(this._grammarFactory=new Yt({logTrace:R=>this._logService.trace(R),logError:(R,x)=>this._logService.error(R,x),readFile:R=>this._extensionResourceLoaderService.readExtensionResource(R)},this._grammarDefinitions||[],Kt,T),this._updateTheme(this._themeService.getColorTheme(),!0),this._grammarFactory)}async _createTokenizationSupport(p){if(!this._languageService.isRegisteredLanguageId(p)||!this._canCreateGrammarFactory())return null;try{const T=await this._getOrCreateGrammarFactory();if(!T.has(p))return null;const R=this._languageService.languageIdCodec.encodeLanguageId(p),x=await T.createGrammar(p,R);if(!x.grammar)return null;const C=sn("editor.maxTokenizationLineLength",p,-1,this._configurationService),r=new $t(x.grammar,x.initialState,x.containsEmbeddedLanguages,(d,h)=>this._threadedBackgroundTokenizerFactory.createBackgroundTokenizer(d,h,C),()=>this.getAsyncTokenizationVerification(),(d,h,n)=>{this._reportTokenizationTime(d,p,x.sourceExtensionId,h,!1,n)},!0);return r.onDidEncounterLanguage(d=>{if(!this._encounteredLanguages[d]){const h=this._languageService.languageIdCodec.decodeLanguageId(d);this._encounteredLanguages[d]=!0,this._languageService.requestBasicLanguageFeatures(h)}}),new Wt(R,r,C)}catch(T){return T.message&&T.message===Te||vt(T),null}}_updateTheme(p,T){if(!T&&this._currentTheme&&this._currentTokenColorMap&&nn(this._currentTheme.settings,p.tokenColors)&&wt(this._currentTokenColorMap,p.tokenColorMap))return;this._currentTheme={name:p.label,settings:p.tokenColors},this._currentTokenColorMap=p.tokenColorMap,this._grammarFactory?.setTheme(this._currentTheme,this._currentTokenColorMap);const R=tn(this._currentTokenColorMap),x=Ct(R);this._styleElement.textContent=x,Re.setColorMap(R),this._currentTheme&&this._currentTokenColorMap&&this._threadedBackgroundTokenizerFactory.acceptTheme(this._currentTheme,this._currentTokenColorMap)}async createTokenizer(p){if(!this._languageService.isRegisteredLanguageId(p))return null;const T=await this._getOrCreateGrammarFactory();if(!T.has(p))return null;const R=this._languageService.languageIdCodec.encodeLanguageId(p),{grammar:x}=await T.createGrammar(p,R);return x}_getVSCodeOniguruma(){return this._vscodeOniguruma||(this._vscodeOniguruma=(async()=>{const p=await this._loadVSCodeOnigurumaWASM();return await Ee.loadWASM({data:p,print:T=>{this._debugModePrintFunc(T)}}),en})()),this._vscodeOniguruma}async _loadVSCodeOnigurumaWASM(){return qe?await(await fetch(ke.asBrowserUri("vscode-oniguruma/../onig.wasm").toString(!0))).arrayBuffer():await fetch(this._environmentService.isBuilt?ke.asBrowserUri(`${Rt}/vscode-oniguruma/release/onig.wasm`).toString(!0):ke.asBrowserUri(`${Ae}/vscode-oniguruma/release/onig.wasm`).toString(!0))}_reportTokenizationTime(p,T,R,x,C,r){const d=C?"async":"sync";_e.reportTokenizationTimeCounter[d]>50||(_e.reportTokenizationTimeCounter[d]===0&&setTimeout(()=>{_e.reportTokenizationTimeCounter[d]=0},1e3*60*60),_e.reportTokenizationTimeCounter[d]++,this._telemetryService.publicLog2("editor.tokenizedLine",{timeMs:p,languageId:T,lineLength:x,fromWorker:C,sourceExtensionId:R,isRandomSample:r,tokenizationSetting:this.getAsyncTokenizationEnabled()?this.getAsyncTokenizationVerification()?2:1:0}))}};xe=_e=Pe([Z(0,Ke),Z(1,xt),Z(2,Ve),Z(3,Qe),Z(4,Pt),Z(5,He),Z(6,Mt),Z(7,Et),Z(8,Ye),Z(9,Je)],xe);function tn(O){const p=[null];for(let T=1,R=O.length;T<R;T++)p[T]=Lt.fromHex(O[T]);return p}function nn(O,p){if(!p||!O||p.length!==O.length)return!1;for(let T=p.length-1;T>=0;T--){const R=p[T],x=O[T];if(R.scope!==x.scope)return!1;const C=R.settings,r=x.settings;if(C&&r){if(C.fontStyle!==r.fontStyle||C.foreground!==r.foreground||C.background!==r.background)return!1}else if(!C||!r)return!1}return!0}function rn(O,p,T,R){if(p.language&&(typeof p.language!="string"||!R.isRegisteredLanguageId(p.language)))return T.error(X("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","invalid.language","Unknown language in `contributes.{0}.language`. Provided value: {1}",ae.name,String(p.language))),!1;if(!p.scopeName||typeof p.scopeName!="string")return T.error(X("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","invalid.scopeName","Expected string in `contributes.{0}.scopeName`. Provided value: {1}",ae.name,String(p.scopeName))),!1;if(!p.path||typeof p.path!="string")return T.error(X("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","invalid.path.0","Expected string in `contributes.{0}.path`. Provided value: {1}",ae.name,String(p.path))),!1;if(p.injectTo&&(!Array.isArray(p.injectTo)||p.injectTo.some(C=>typeof C!="string")))return T.error(X("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","invalid.injectTo","Invalid value in `contributes.{0}.injectTo`. Must be an array of language scope names. Provided value: {1}",ae.name,JSON.stringify(p.injectTo))),!1;if(p.embeddedLanguages&&!Fe(p.embeddedLanguages))return T.error(X("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","invalid.embeddedLanguages","Invalid value in `contributes.{0}.embeddedLanguages`. Must be an object map from scope name to language. Provided value: {1}",ae.name,JSON.stringify(p.embeddedLanguages))),!1;if(p.tokenTypes&&!Fe(p.tokenTypes))return T.error(X("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","invalid.tokenTypes","Invalid value in `contributes.{0}.tokenTypes`. Must be an object map from scope name to token type. Provided value: {1}",ae.name,JSON.stringify(p.tokenTypes))),!1;const x=Xe(O,p.path);return At(x,O)||T.warn(X("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","invalid.path.1","Expected `contributes.{0}.path` ({1}) to be included inside extension's folder ({2}). This might make the extension non-portable.",ae.name,x.path,O.path)),!0}function sn(O,p,T,R){return Ue(x=>R.onDidChangeConfiguration(C=>{C.affectsConfiguration(O,{overrideIdentifier:p})&&x(C)}),()=>R.getValue(O,{overrideIdentifier:p})??T)}const ze=new URL("/assets/onig-Du5pRr7Y.wasm",import.meta.url).href;Nt({"vscode-oniguruma/../onig.wasm":ze,"vs/../../node_modules/vscode-oniguruma/release/onig.wasm":ze});jt(async O=>{O.get(zt).when(2).then(()=>{Bt.get(Ze)})});let ye=class{constructor(p){this.instantiationService=p,this.instantiationService.createInstance(Ft)}};ye.ID="workbench.contrib.extensionPoints.textmate";ye=Pe([Z(0,Ye)],ye);Ot(ye.ID,ye,1);function ln(){return{...Gt(),[Ze.toString()]:new Dt(xe,[],!1)}}export{Ze as ITextMateTokenizationService,ln as default};
